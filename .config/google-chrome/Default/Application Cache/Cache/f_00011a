EU.prototype.cra=ga(222,function(a){this.O=Pb(arguments,0)});function f9b(a,b,c,d,e){return Qkb(a,y(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function RV(a){aj(this,a,0,-1,null)}z(RV,$i);function g9b(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),g=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;g.push(new th(m,k,m+b,k+c))}return g}var h9b=[2];
function i9b(a){return nc(v8b,function(b){return b.match(a)}).getName()}function j9b(a,b){var c=a.type;if(u(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(za(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":za(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,g=0;e=b[g];g++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}}
function k9b(a){var b=a.type;if(!u(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return u(a.value)?a.value:null}}function l9b(a){aj(this,a,0,-1,null)}z(l9b,$i);var m9b={cnc:0,Nya:1,mza:2};function n9b(a){aj(this,a,0,-1,h9b)}z(n9b,$i);
function o9b(a,b,c){function d(){g=la.setTimeout(e,b);a.apply(null,k)}function e(){g=null;h&&(h=!1,d())}c&&(a=y(a,c));var g=null,h=!1,k=[];return function(a){k=arguments;g?h=!0:d()}}function p9b(a){for(var b=Math.random,c=a.length-1;0<c;c--){var d=Math.floor(b()*(c+1)),e=a[c];a[c]=a[d];a[d]=e}}function SV(a,b,c,d,e,g){K.call(this,a,b);this.C=b;this.Na=c;this.Pa=d||null;this.wb=e||null;this.F=g||null}z(SV,K);SV.prototype.Dj=f("Na");SV.prototype.Ve=f("Pa");
function q9b(a,b,c,d,e,g){SV.call(this,"assistant-sidepane-insert-chart",null,d,e,g);this.Y=a;this.$=b;this.fc=c}z(q9b,SV);q9b.prototype.Se=f("fc");function r9b(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(rt({Oe:"waffle-assistant-section-more-button",content:ks("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function TV(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Xa(b),qt(a,b,void 0),h5b(a),a.setAttribute("data-tooltip-delay",500),i5b(a,u(c)?c:1))};function s9b(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function t9b(a,b,c){c=c||{};a=V;b='<div class="waffle-assistant-scroll-pane" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">';c=c||{};c=""+('<div class="waffle-assistant-empty-list" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none"><div class="waffle-assistant-empty-list-content">'+U(s9b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
c=V(c);return a(b+c+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}function u9b(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(rt({Oe:"waffle-assistant-panel-back-button",content:ks(""+U(Pu({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function UV(a){wq.call(this,a);this.Bd=new KV(!1,"#4285f4");this.Ma(this.Bd);this.O=new wq(this.oa);this.Ma(this.O);this.D=[];this.Gg=this.Wc=!1;this.Ke=this.Yd=this.Ua=this.$=null;this.Gb=new st("",a,4);rr(this.Gb,2);this.Ma(this.Gb)}z(UV,wq);var v9b={defaultHelpArticleId:"6280499"};q=UV.prototype;q.Sa=function(){UV.Z.Sa.call(this);this.Ba=Or(t9b);this.Yd=T(this,"waffle-assistant-panel-content-container");this.Ke=T(this,"waffle-assistant-empty-list")};
q.Ha=function(){UV.Z.Ha.call(this);var a=T(this,"waffle-assistant-spinner-container");this.Bd.render(a);this.O.Va(T(this,"waffle-assistant-panel-card-holder"));this.Gb.Va(T(this,"waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Gb,"action",this.gWb).V(this.Ba,"scroll",o9b(this.zVa,10,this))};q.setVisible=function(a){R(this.Ba,a);A(this.D,function(a){if(!a.rc()){var b=this.O.qd();a.Y=b;this.O.Ma(a,!0);a.sO()}},this);this.Wc=a};
q.wqa=function(a,b){var c=this.oa;this.$&&this.Z4();this.$=new wq;this.Ma(this.$);a=Mr(a,u9b,{title:b});this.Ua=new st("",this.oa);this.$.Ma(this.Ua);this.Ua.Va(yn(c,"waffle-assistant-panel-back-button",a));TV(this.Ua.Ba,"Back");this.$.getHandler().V(this.Ua,"action",this.kib)};q.Z4=function(){this.$.dispose();this.$=null};function w9b(a,b){a.Bd.setActive(b);R(T(a,"waffle-assistant-panel-pane"),!b)}q.nL=function(a){R(this.Ke,a);R(this.Yd,!a)};
function x9b(a,b){Jb(a.D,b);a.O.removeChild(b);a.O.wi(b,0);a.D.push(b)}q.WK=function(a){Jb(this.D,a);-1!=Fq(this.O,a)&&this.O.removeChild(a,!0)};q.j4=function(){this.O.Qd(!0);Kc(this.D);this.D=[]};q.zVa=function(){for(var a=this.Ba,a=a.scrollTop+cq(a).height,b=0,c=0;c<this.D.length;c++){var d=this.D[c];b<a?(VV(d,!0),b+=cq(d.Ba).height):VV(d,!1)}};function y9b(a,b){a.Gg=b;A(a.D,function(a){a.DG(b)})}q.Id=f("Gg");q.gWb=function(){Q.Hm.Wb(v9b)};q.kib=function(){this.dispatchEvent("assistant-sidepane-back-button-clicked")};function WV(a,b,c,d){wq.call(this,d);this.R=a;this.Xa=b;this.X=new st("",this.oa);this.Ma(this.X);this.J=new wq(this.oa);this.Ma(this.J);this.D=null;this.Ua=[];this.Na=this.Ka=!1;this.O=c}z(WV,wq);q=WV.prototype;q.ELa=Kf;q.Lra=Lf;q.Sa=function(){WV.Z.Sa.call(this);this.Ba=Or(r9b,{title:this.yT()})};
q.Ha=function(){WV.Z.Ha.call(this);this.J.Va(T(this,"waffle-assistant-section-card-holder"));this.X.Va(T(this,"waffle-assistant-section-more-button"));this.getHandler().V(this.X,"action",this.Bsb);this.D=this.NBa();H(this,this.D);R(z9b(this),this.ELa());this.setVisible(!1)};q.setVisible=function(a){if(this.rc()&&this.Ta()!=a&&(R(this.Ba,a),a)){R(this.X.Ba,this.OSa());a=new l9b;var b=this.Mca();P(a,4,b);b=new io;fj(b,58,a);this.O.Pb(2774,new Uo(10,b))}};q.Ta=function(){return this.rc()&&fq(this.Ba)};
q.OSa=function(){return this.Ua.length>this.R};q.yT=v;q.uW=v;q.NBa=function(){return new UV(this.oa)};q.t1=function(a){this.Na=a;A(A9b(this),function(b){b.DG(a)});y9b(this.D,a)};q.Id=f("Na");q.lh=oa;q.a4=v;q.Mca=v;q.Nta=function(a){this.Ua=a;for(var b=0;b<a.length;b++){Gc(a[b],1);if(this.J.qd()<this.R){var c=this.uW(a[b]);c.DG(this.Na);var d=this.J.qd();c.Y=d;this.J.Ma(c,!0)}if(this.Lra()&&(this.D.nL(!1),c=this.D,d=this.uW(a[b]),c.D.push(d),c.Wc)){w9b(c,!1);var e=c.O.qd();d.Y=e;c.O.Ma(d,!0);d.sO()}}};
function A9b(a){var b=[];a.J.wg(function(a){b.push(a)});return b}function z9b(a){return T(a,"waffle-assistant-section-content")}q.Pma=function(){return Cua(this.J)};q.s1=function(){this.Ua=[];Kc(this.J.Qd(!0));this.setVisible(!1);this.Lra()&&(this.D.j4(),this.D.nL(!0))};function B9b(a){a.J.wg(function(a,c){c<this.R&&a.sO()},a)}
q.Ota=function(a){var b=0;if(this.Ka)this.D.zVa();else if(this.Pma()){this.setVisible(!0);for(var b=cq(T(this,"waffle-assistant-section-header")).height+cq(z9b(this)).height,c=A9b(this),d=0;d<c.length;d++)b<a&&d<this.R?(this.IIa(c[d]),VV(c[d],!0),b+=cq(c[d].Ba).height):VV(c[d],!1)}else this.setVisible(!1);return a-b};q.IIa=oa;q.setActive=function(a){(this.Ka=a)||this.D.Z4()};q.Ob=f("Ka");function C9b(a,b){a.D.wqa(b,a.yT())}q.Bsb=function(){this.setActive(!0);this.dispatchEvent("assistant-sidepane-set-active-panel")};var D9b={UNKNOWN_ERROR:0,unc:1,sgc:2,c5b:3},E9b={knc:0,lC:1,ygc:2,bgc:3,oic:4},F9b={gnc:0,ugc:1,wH:2,fec:3},G9b={anc:0,Omc:1,J8b:2,dmc:3,bmc:4};function XV(){B.call(this)}z(XV,B);var H9b=null;XV.prototype.xl=function(){return D(this,1)};function YV(){B.call(this)}z(YV,B);var I9b=null;YV.prototype.getText=function(){return D(this,1)};YV.prototype.rq=function(){return Ac(this,1)};function ZV(){B.call(this)}z(ZV,B);var J9b=null;ZV.prototype.getStatus=function(){return D(this,1)};ZV.prototype.hasFormula=function(){return Ac(this,2)};ZV.prototype.getError=function(){return D(this,9)};function $V(){B.call(this)}z($V,B);var K9b=null;q=$V.prototype;
q.b9=function(){return Ac(this,1)};q.hasFormula=function(){return Ac(this,2)};q.getType=function(){return D(this,3)};q.Ed=function(a){F(this,3,a)};q.mf=function(){return Ac(this,3)};XV.prototype.Ca=function(){var a=H9b;a||(H9b=a=Ic(XV,{0:{name:"Error",gb:"ritz.assistant.Error"},1:{name:"message",Aa:9,type:String},2:{name:"code",Aa:14,defaultValue:0,type:D9b}}));return a};XV.Ca=XV.prototype.Ca;
YV.prototype.Ca=function(){var a=I9b;a||(I9b=a=Ic(YV,{0:{name:"AnswerQueryPhrase",gb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Aa:9,type:String},2:{name:"start_byte",Aa:5,type:Number},3:{name:"num_bytes",Aa:5,type:Number}}));return a};YV.Ca=YV.prototype.Ca;
ZV.prototype.Ca=function(){var a=J9b;a||(J9b=a=Ic(ZV,{0:{name:"AnswerResponse",gb:"ritz.assistant.AnswerResponse"},1:{name:"status",Aa:5,type:Number},10:{name:"parse_status",Aa:14,defaultValue:0,type:E9b},11:{name:"answer_status",Aa:14,defaultValue:0,type:F9b},2:{name:"formula",Aa:9,type:String},3:{name:"debug_parse_response",Aa:9,type:String},4:{name:"interpretation",Aa:9,type:String},5:{name:"debug_interpretation_response",Aa:9,type:String},6:{name:"unused_phrase",td:!0,Aa:11,type:YV},7:{name:"used_entity_phrase",
td:!0,Aa:11,type:YV},8:{name:"unused_entity_phrase",td:!0,Aa:11,type:YV},9:{name:"error",Aa:11,type:XV},12:{name:"alternate_suggestion",td:!0,Aa:11,type:$V}}));return a};ZV.Ca=ZV.prototype.Ca;$V.prototype.Ca=function(){var a=K9b;a||(K9b=a=Ic($V,{0:{name:"QuerySuggestion",gb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Aa:9,type:String},2:{name:"formula",Aa:9,type:String},3:{name:"type",Aa:14,defaultValue:0,type:G9b}}));return a};$V.Ca=$V.prototype.Ca;function aW(){B.call(this)}z(aW,B);var L9b=null;aW.prototype.getChartType=function(){return D(this,1)};
aW.prototype.Ca=function(){var a=L9b;a||(L9b=a=Ic(aW,{0:{name:"AutovisRecommendationProto",gb:"ritz.assistant.AutovisRecommendationProto"},1:{name:"chart_type",Aa:9,type:String},2:{name:"chart_title",Aa:9,type:String},3:{name:"horizontal_axis_title",Aa:9,type:String},4:{name:"horizontal_axis_min",Aa:1,type:Number},5:{name:"horizontal_axis_max",Aa:1,type:Number},6:{name:"left_vertical_axis_title",Aa:9,type:String},7:{name:"left_vertical_axis_min",Aa:1,type:Number},8:{name:"left_vertical_axis_max",
Aa:1,type:Number},9:{name:"right_vertical_axis_title",Aa:9,type:String},10:{name:"right_vertical_axis_min",Aa:1,type:Number},11:{name:"right_vertical_axis_max",Aa:1,type:Number},12:{name:"columns_to_group_by",td:!0,Aa:5,type:Number},13:{name:"column_aggregation_types",td:!0,Aa:9,type:String},14:{name:"is_transposed",Aa:8,type:Boolean},15:{name:"use_first_column_as_domain",Aa:8,type:Boolean},16:{name:"first_data_row_index",Aa:5,type:Number},17:{name:"is_stacked",Aa:8,type:Boolean},18:{name:"autovis_range",
Aa:11,type:Rd},19:{name:"text_analysis_words",td:!0,Aa:9,type:String},20:{name:"text_analysis_word_counts",td:!0,Aa:5,type:Number},21:{name:"mapped_column_label",td:!0,Aa:9,type:String},22:{name:"best_facet_column",Aa:5,type:Number},23:{name:"best_facet_labels",td:!0,Aa:9,type:String},24:{name:"needs_data_transformation",Aa:8,type:Boolean},25:{name:"data_transformation",Aa:11,type:ef}}));return a};aW.Ca=aW.prototype.Ca;var M9b={vea:0,kda:1,L1:2,N2:3};function bW(){B.call(this)}z(bW,B);var N9b=null;q=bW.prototype;q.getName=function(){return D(this,1)};q.vh=function(a){F(this,1,a)};q.getType=function(){return D(this,4)};q.Ed=function(a){F(this,4,a)};q.mf=function(){return Ac(this,4)};function cW(){B.call(this)}z(cW,B);var O9b=null;cW.prototype.getName=function(){return D(this,1)};cW.prototype.vh=function(a){F(this,1,a)};function dW(){B.call(this)}z(dW,B);var P9b=null;dW.prototype.$d=function(a){return D(this,2,a)};
dW.prototype.Ro=function(){return Ac(this,2)};bW.prototype.Ca=function(){var a=N9b;a||(N9b=a=Ic(bW,{0:{name:"Dimension",gb:"ritz.assistant.Dimension"},1:{name:"name",Aa:9,type:String},2:{name:"filter",td:!0,Aa:9,type:String},3:{name:"non_unique_filter",td:!0,Aa:13,type:Number},4:{name:"type",Aa:14,defaultValue:0,type:M9b},5:{name:"year_only_dates",Aa:8,type:Boolean},6:{name:"density",Aa:1,type:Number},7:{name:"alt_name",td:!0,Aa:9,type:String}}));return a};bW.Ca=bW.prototype.Ca;
cW.prototype.Ca=function(){var a=O9b;a||(O9b=a=Ic(cW,{0:{name:"Metric",gb:"ritz.assistant.Metric"},1:{name:"name",Aa:9,type:String},2:{name:"alt_name",td:!0,Aa:9,type:String}}));return a};cW.Ca=cW.prototype.Ca;dW.prototype.Ca=function(){var a=P9b;a||(P9b=a=Ic(dW,{0:{name:"EntityListTable",gb:"ritz.assistant.EntityListTable"},1:{name:"metric",td:!0,Aa:11,type:cW},2:{name:"dimension",td:!0,Aa:11,type:bW},3:{name:"non_unique_dimension",td:!0,Aa:13,type:Number}}));return a};dW.Ca=dW.prototype.Ca;var Q9b={CZb:0,oH:1,m0b:2,bZb:3,sWa:4};function eW(){B.call(this)}z(eW,B);var R9b=null;function fW(){B.call(this)}z(fW,B);var S9b=null;fW.prototype.Pf=function(a){return D(this,4,a)};function gW(){B.call(this)}z(gW,B);var T9b=null;q=gW.prototype;q.xS=function(){return D(this,2)};q.ah=function(){return D(this,3)};q.mJ=function(){return D(this,4,0)};q.getPivotTableDef=function(){return D(this,5)};q.Efa=function(){return Fc(this,7)};q.getAutovisRecommendation=function(){return D(this,8)};
function hW(){B.call(this)}z(hW,B);var U9b=null;eW.prototype.Ca=function(){var a=R9b;a||(R9b=a=Ic(eW,{0:{name:"AssistantResponseProto",gb:"ritz.assistant.AssistantResponseProto"},1:{name:"recommendation",td:!0,Aa:11,type:gW},2:{name:"selection_recommendation",td:!0,Aa:11,type:gW}}));return a};eW.Ca=eW.prototype.Ca;
fW.prototype.Ca=function(){var a=S9b;a||(S9b=a=Ic(fW,{0:{name:"AssistantRequestProto",gb:"ritz.assistant.AssistantRequestProto"},1:{name:"table_range",Aa:11,type:Rd},2:{name:"selected_row",td:!0,Aa:5,type:Number},3:{name:"selected_column",td:!0,Aa:5,type:Number},4:{name:"color",td:!0,Aa:11,type:sd},5:{name:"color_frequency",td:!0,Aa:5,type:Number}}));return a};fW.Ca=fW.prototype.Ca;
gW.prototype.Ca=function(){var a=T9b;a||(T9b=a=Ic(gW,{0:{name:"RecommendationProto",gb:"ritz.assistant.RecommendationProto"},1:{name:"recommendation_type",Aa:14,defaultValue:0,type:Q9b},2:{name:"confidence",Aa:1,type:Number},3:{name:"description",Aa:9,type:String},4:{name:"grid_ranges",td:!0,Aa:11,type:Rd},5:{name:"pivot_table_def",Aa:11,type:Ne},6:{name:"conditional_format_rules",td:!0,Aa:11,type:Ue},7:{name:"banding_protos",td:!0,Aa:11,type:Fd},8:{name:"autovis_recommendation",Aa:11,type:aW},9:{name:"entity_list_table",
Aa:11,type:dW}}));return a};gW.Ca=gW.prototype.Ca;
hW.prototype.Ca=function(){var a=U9b;a||(U9b=a=Ic(hW,{0:{name:"AssistantFlagsProto",gb:"ritz.assistant.AssistantFlagsProto"},2:{name:"include_word_clouds",Aa:8,type:Boolean},3:{name:"include_conditional_formats",Aa:8,type:Boolean},4:{name:"include_forms_integration",Aa:8,type:Boolean},5:{name:"include_answers",Aa:8,type:Boolean},6:{name:"include_autovis_faceting",Aa:8,type:Boolean},7:{name:"include_banding",Aa:8,type:Boolean},9:{name:"include_autovis_sum",Aa:8,type:Boolean},10:{name:"include_already_applied_formatting_recommendations",
Aa:8,type:Boolean}}));return a};hW.Ca=hW.prototype.Ca;function V9b(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(fm?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(fm?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function iW(){}z(iW,EI);pa(iW);iW.prototype.tc=n("waffle-assistant-link-button");function W9b(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function X9b(a,b){wq.call(this,b);this.D=a;this.C=new lt("",new iW,this.oa);this.Ma(this.C)}z(X9b,wq);q=X9b.prototype;q.Sa=function(){this.Ba=Or(W9b)};q.Ha=function(){X9b.Z.Ha.call(this);var a=T(this,"waffle-assistant-feedback-card-link");this.C.Va(a);this.getHandler().V(this.Ba,"mousedown",this.fWb).V(this.C,"action",this.Jnb);this.show(!1)};q.fWb=function(a){a.stopPropagation()};
q.show=function(a){var b=this.Ba,c=T(this,"waffle-assistant-feedback-card-link");Hp(b,"waffle-assistant-feedback-card-hidden",!a);pn(c,a)};q.Jnb=function(){Q.ax.Wb({source:this.D});this.show(!1);this.dispatchEvent(new K("feedback-dialog-opened"))};function jW(){}z(jW,jt);pa(jW);jW.prototype.tc=n("waffle-assistant-button");function Y9b(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(Pu({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(Pu({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function kW(a){wq.call(this,a);this.C=new lt("",new jW,this.oa);this.Ma(this.C);this.D=new lt("",new jW,this.oa);this.Ma(this.D)}z(kW,wq);kW.prototype.Sa=function(){this.Ba=Or(Y9b)};kW.prototype.Ha=function(){kW.Z.Ha.call(this);var a=T(this,"waffle-assistant-thumbs-down-button");this.C.Va(a);TV(a,"Not useful");a=T(this,"waffle-assistant-thumbs-up-button");this.D.Va(a);TV(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.J)};
function Z9b(a,b){a.oa.Nf(T(a,"waffle-assistant-thumbs-text"),b)}kW.prototype.F=function(){this.dispatchEvent(new K("thumbs-down"));R(this.Ba,!1)};kW.prototype.J=function(){this.dispatchEvent(new K("thumbs-up"));R(this.Ba,!1)};function lW(a,b){wq.call(this,b);this.D=a;this.X=this.F=this.Y=null;this.Xa=new KV(!0,"#4285f4");this.Ma(this.Xa);this.bb=this.qc=this.Yd=!1;this.$=null;this.Gf=this.Qb=!1}z(lW,wq);q=lW.prototype;q.cz=v;q.Vy=v;q.YMa=Kf;q.xT=Kf;q.c9=Lf;q.Px=v;q.iE=Mf;q.hE=Mf;q.w7=Mf;q.kka=Mf;q.jka=Mf;q.DG=ea("Gf");q.Id=f("Gf");q.B8=oa;q.Sa=function(){this.Ba=Or(V9b)};
q.Ha=function(){lW.Z.Ha.call(this);var a=T(this,"waffle-assistant-card-spinner-container");this.Xa.render(a);Kp(T(this,"waffle-assistant-card-inner"),"visibility","hidden");if(this.xT()){var a=this.Ba,b=new vq(a);H(this,b);this.getHandler().V(b,"focusin",this.Rib).V(b,"focusout",this.Qib).V(a,"mouseenter",this.rma).V(a,"mouseleave",this.I8)}$9b(this,!1);fm&&(this.X=new X9b(this.Px(),this.oa),this.X.render(T(this,"waffle-assistant-card-feedback-container")),this.getHandler().V(this.X,"feedback-dialog-opened",
this.Knb).V(this,"trigger_feedback",this.gQb),this.c9()?(this.F=new kW(this.oa),this.F.render(T(this,"waffle-assistant-thumbs-container")),a$b(this,!0),a=Sa(this.w7()),Qa(a)||Z9b(this.F,a),a=Sa(this.kka()),Qa(a)||TV(T(this.F,"waffle-assistant-thumbs-up-button"),a),a=Sa(this.jka()),Qa(a)||TV(T(this.F,"waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.F,"thumbs-down",this.dWb).V(this.F,"thumbs-up",this.eWb)):a$b(this,!1));this.Vy()};
function mW(a){return T(a,"waffle-assistant-card-content-container")}function b$b(a){a.xT();return T(a,"waffle-assistant-card-options")}function a$b(a,b){fm&&R(T(a,"waffle-assistant-thumbs-container"),a.c9()&&b)}q.sO=function(){this.isDisposed()||(this.Yd=!0,c$b(this))};function VV(a,b){!a.qc&&b&&(a.qc=!0,c$b(a))}function c$b(a){if(a.Yd&&a.qc){var b=y(a.cWb,a);a.cz(b)}}q.rma=function(){this.bb||($9b(this,!0),this.bb=!0,cl(this.$),this.$=bl(this.WAa,100,this))};
q.WAa=function(){this.isDisposed()||(cl(this.$),this.$=null,this.Ba.parentNode.querySelector(":hover")==this.Ba?this.$=bl(this.WAa,100,this):this.I8())};q.I8=function(){$9b(this,!1);this.bb=!1};q.Rib=function(){$9b(this,!0)};q.Qib=function(){bl(function(){this.isDisposed()||kn(this.Ba,document.activeElement)||this.Ba.parentNode.querySelector(":hover")==this.Ba||$9b(this,!1)},0,this)};
q.dWb=function(){d$b(this,!0);a$b(this,!1);var a=this.hE();this.dispatchEvent(new SV("assistant-sidepane-thumbs",this,a))};q.eWb=function(){a$b(this,!1);var a=this.iE();this.dispatchEvent(new SV("assistant-sidepane-thumbs",this,a))};q.Knb=function(){d$b(this,!1)};q.gQb=function(){d$b(this,!0)};function $9b(a,b){var c=T(a,"waffle-assistant-card-options");a=a.xT();R(c,a&&b)}q.cWb=function(){this.Xa.setActive(!1);R(this.Xa.Ba,!1);Kp(T(this,"waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new K("content-rendered"))};
function d$b(a,b){Hp(T(a,"waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.X.show(b)};function e$b(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function f$b(){return V(U(rt({Oe:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:ks(""+U(Pu({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(rt({Oe:"waffle-assistant-zoom-button",content:ks(""+U(Pu({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function g$b(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.w3a)+"</span>"),d=0==a.aFa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">\x3c!-- Create chart containers with two in each row. --\x3e';a=a.aFa;for(var e=a.length,g=0;g<e;g++)var h=a[g],c=c+((0==g%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==g%2||g==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+
(d?" waffle-assistant-facet-white-section":"")+'">'+c+(fm?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function h$b(a,b,c,d,e,g,h){wq.call(this,h);this.F=a;this.D=b;this.L=e;this.J=g;this.C=this.fc=null;this.Tc=Wo(new Vo,10).Fa()}z(h$b,wq);q=h$b.prototype;q.Ha=function(){h$b.Z.Ha.call(this);(new mV(QH,this.D.Sg)).send(y(this.dlb,this,this.D))};q.B8=function(a,b){a=new q9b(this.F.clone(),this.L,this.fc,2746,a,b);this.dispatchEvent(a)};q.dlb=function(a,b){b&&(b.$h()?pH.Ez(this.Ba,b):(b=b.Se(),a.Ef(b),AV(a,b),qH(a,"ready",y(this.WVb,this,a)),HV(a,this.Ba,pm),this.fc=b))};
q.WVb=function(a){a.Rl()&&(qH(a.Rl(),"onmouseover",y(this.UVb,this)),qH(a.Rl(),"onmouseout",y(this.VVb,this)))};q.UVb=function(){this.C=Ha()};q.VVb=function(){Ba(this.C)&&500<Ha()-this.C&&this.J.Pb(2750,this.Tc);this.C=null};function i$b(a,b,c,d,e){wq.call(this,e);this.J=a;this.Ka=b;this.O=c;this.R=d;this.L=Fc(this.J,23);this.Da=D(this.J,22);this.D=Fc(this.J,21)[this.Da];this.ea=[];this.Na=new Li;this.X=this.F=this.C=null;this.Y=!1;this.$=new st("",this.oa);this.Ma(this.$);this.Tc=Wo(new Vo,10).Fa()}z(i$b,wq);q=i$b.prototype;q.Sa=function(){i$b.Z.Sa.call(this);this.Ba=Or(g$b,{w3a:this.D,aFa:this.L});this.Ba.style.visibility="hidden"};
q.Ha=function(){i$b.Z.Ha.call(this);var a=T(this,"waffle-assistant-facet-toggle");this.$.Va(a);this.getHandler().V(this.Ba,"mousedown",this.RVb).V(this.$,"action",this.eAb);fm&&(this.X=new X9b("assistantAutovisFacetFeedback",this.oa),this.X.render(T(this,"waffle-assistant-facet-feedback-container")),this.C=new kW(this.oa),this.Ma(this.C),this.C.render(T(this,"waffle-assistant-facet-thumbs-container")),Z9b(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.TVb).V(this.C,"thumbs-down",this.SVb));j$b(this,woa)};q.Id=f("Y");q.RVb=function(a){a.stopPropagation()};q.eAb=function(){var a=Cp(T(this,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");j$b(this,a);this.O.Pb(a?2647:2646,this.Tc)};
function j$b(a,b){var c=T(a,"waffle-assistant-facet-toggle");nn(c,b?"HIDE":"SHOW");Hp(T(a,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(yq(a,"waffle-assistant-faceted-chart"),function(a){pn(a,b)});a.C&&R(a.C.Ba,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');TV(c,b?a:d)}
function k$b(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function l$b(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function m$b(a){a.R&&!a.Y&&A(a.ea,y(function(a){var b=a.Ba;if(!this.R.contains(b)){var d=this.R;a=new n$b(b,a);Whb(d,a)}},a))}q.TVb=function(){this.O.Pb(2649,this.Tc)};q.SVb=function(){this.O.Pb(2648,this.Tc);this.X.show(!0)};function nW(a,b,c,d,e,g){lW.call(this,a,g);this.C=a.getAutovisRecommendation();this.$e=b;this.Ke=c;this.R=d;this.Ua=e;this.O=new st("",this.oa);this.Ma(this.O);this.Za=new st("",this.oa);this.Ma(this.Za);this.Le=new Li;this.Bd=null;this.Ka=!1;this.Wc=[];this.Qc=[];this.Gb=[];this.Na=this.Da=this.J=this.L=this.ea=null;this.Tc=Wo(new Vo,10).Fa()}z(nW,lW);
var o$b={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}},p$b=["BarChart","ColumnChart"],oW={$Va:"waffle-assistant-after-chart-preview",vWa:"waffle-assistant-before-chart-preview",IWa:"waffle-assistant-card-draggable",
q2:"waffle-assistant-chart-highlights",VYa:"waffle-assistant-insert-chart-button",eea:"waffle-assistant-chart-preview",G_a:"waffle-assistant-button-separator",b0a:"waffle-assistant-styled-border",c0a:"waffle-assistant-styled-rect",a1a:"waffle-assistant-zoom-button"};q=nW.prototype;q.cz=function(a){this.Bd=a;q$b(this)};q.Vy=function(){r$b(this,y(function(a){a=x8b(this.$e,a);Ap(this.Ba,a)},this),!1)};q.YMa=Lf;q.xT=Lf;q.Px=n("autovisFeedback");q.iE=n(2208);q.hE=n(2207);q.w7=n("Was this chart useful?");
q.Sa=function(){nW.Z.Sa.call(this);mW(this).appendChild(Or(e$b));b$b(this).appendChild(Or(f$b));if(Ac(this.C,22)){this.J=new i$b(this.C,this.Y,this.R,this.Ua,this.oa);this.Ma(this.J,!0);var a=this.J,b=this.Id();a.Y=b;m$b(a)}};
q.Ha=function(){nW.Z.Ha.call(this);Dp(this.Ba,oW.IWa);var a=T(this,oW.VYa);this.O.Va(a);TV(a,"Insert chart");a=T(this,oW.a1a);this.Za.Va(a);TV(a,"View full size");var a=T(this,oW.vWa),b=T(this,oW.eea),c=T(this,oW.$Va);this.getHandler().V(this.Ba,"keydown",this.OVb).V(b,"click",this.wjb).V(a,"focus",this.sib).V(c,"focus",this.nhb).V(this.O,"action",this.dqb).V(this.O.Ba,"mousedown",this.Mta).V(this.Za,"action",this.TBb).V(this.Za.Ba,"mousedown",this.Mta).V(T(this,oW.q2),"mousedown",this.Mta).V(vw(this.$e),
"Ib",this.PVb);s$b(this);this.R.Pb(2790,this.Tc);this.J&&this.R.Pb(2791,this.Tc)};q.DG=function(a){nW.Z.DG.call(this,a);s$b(this);this.rc()&&t$b(this)};function s$b(a){if(a.rc()){var b=a.Id();a.O.setVisible(!b);a=yn(a.oa,oW.G_a,b$b(a));R(a,!b)}}q.OVb=function(a){13==a.keyCode&&a.target==this.Ba&&(a.preventDefault(),a.stopPropagation(),u$b(this,2255))};
function v$b(a){for(var b=a.getChartType(),c=!!D(a.C,14),d=D(a.C,16),e=!!D(a.C,15),g="Histogram"==b,h="PieChart"==b,k=pW(a),l=1<k.length,m=[],b=0;b<k.length;b++){var p=w$b(k[b].rect,c!=h);Ob(m,p)}var b=fA(a.Ke).ud(),r=vb(hc(Yg),b.q1,b),c=vb(m,function(a){return vb(r,Fa(xh,a))});g&&e&&(c=Pb(c,1));a.Gb=x$b(c.length,h&&0<d||!g&&!h&&e,h&&l);d=fA(a.Ke);for(b=0;b<c.length;b++)for(e=a.Gb[b],g=0;g<c[b].length;g++)c[b][g]&&Jh(c[b][g])&&(h=OT(d,c[b][g],oW.c0a),H(a,h),AF(lI(d),h,!0),Kp(h.Ba,"background-color",
e),h.setVisible(!0),a.Wc.push(h),h=SH(d,c[b][g],oW.b0a,1,0),H(a,h),PXa(h,e),h.setVisible(!0),a.Qc.push(h))}function y$b(a){Kc(a.Wc);Kc(a.Qc);a.Wc=[];a.Qc=[];a.Gb=[]}q.PVb=function(){this.Ka&&(y$b(this),v$b(this))};q.rma=function(){nW.Z.rma.call(this);this.Da=Ha();this.Ka||(v$b(this),this.Ka=!0)};q.I8=function(){nW.Z.I8.call(this);Ba(this.Da)&&500<Ha()-this.Da&&this.R.Pb(2789,this.Tc);this.Da=null;y$b(this);this.Ka=!1};q.wjb=function(){this.Ba.focus()};
q.sib=function(){var a=T(this,oW.q2);if(fq(a))a.focus();else{if(a=this.F)a=T(this.F,"waffle-assistant-thumbs-up-button"),fq(a)?(a.focus(),a=!0):a=!1;a||this.O.Ba.focus()}};q.nhb=function(){var a;if(a=this.X)a=this.X,T(a,"waffle-assistant-feedback-card-hidden")?a=!1:(T(a,"waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Ba.focus()};q.dqb=function(){this.R.Pb(2255,this.Tc);u$b(this,2255)};q.Mta=function(a){a.stopPropagation()};q.TBb=function(){X.K1.Wb(this)};
q.B8=function(a,b){u$b(this,2257,a,b)};function u$b(a,b,c,d){r$b(a,y(function(a){a=new q9b(a,this.Y,this.L&&this.L.Se(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.QVb=function(a,b){if(b){var c=T(this,oW.eea);if(b.$h())pH.Ez(c,b);else{a.Ef(b.Se());AV(a,a.Se());fU(a,"ready",y(this.NVb,this,a));b=[];try{var d=new df;d.setContext(a.toJSON());var e=!!D(this.C,14);F(d,3,e);var g=D(this.C,16);F(d,4,g);F(d,5,"ROWS"==(e?"ROWS":"COLS"));F(d,8,0);var h;if(D(this.C,24)){h=[LT(D(this.C,18))];var k=D(this.C,25);F(d,9,k)}else h=pW(this);for(e=0;e<h.length;e++)d.addRange(Ph(h[e].rect,h[e].vd));var l=this.Le.serialize(d);b=vb(F8b(Fa(ritz.getVerbalHighlightsForProto,l),a).call(),
C8b)}catch(m){b=[]}d=T(this,oW.q2);R(d,0<b.length);0<b.length&&(d.appendChild(b[0]),pn(d,!0));this.L=a;HV(a,c,pm)}}};q.NVb=function(a){null!==this.ea&&(yJ(wJ.getInstance(),this.ea),this.ea=null);this.isDisposed()||(a.Rl()&&(qH(a.Rl(),"onmouseover",y(this.LVb,this)),qH(a.Rl(),"onmouseout",y(this.MVb,this))),this.Bd(),t$b(this))};q.LVb=function(){this.Na=Ha()};q.MVb=function(){Ba(this.Na)&&500<Ha()-this.Na&&this.R.Pb(2795,this.Tc);this.Na=null};
function t$b(a){if(a.Ua&&!a.Id()){var b=T(a,oW.eea);if(!a.Ua.contains(b)){var c=a.Ua;a=new n$b(b,a);Whb(c,a)}}}
function z$b(a){a.Qb&&(a.ea=xJ(wJ.getInstance(),lj.sua),a.Qb=!1);var b=new BH(uc(o$b)),c=a.C.getChartType(),d=D(a.C,16),e=!!D(a.C,14),e=1<pW(a).length||!e&&1<pW(a)[0].rect.width||e&&1<pW(a)[0].rect.height;("PieChart"==c&&!e||"PieChart"!=c&&0>=d)&&b.setOption("legend.position","none");b.setOption("title",D(a.C,2));b.setOption("hAxis.title",D(a.C,3));Ac(a.C,4)&&b.setOption("hAxis.viewWindow.min",D(a.C,4));Ac(a.C,5)&&b.setOption("hAxis.viewWindow.max",D(a.C,5));b.setOption("vAxes.0.title",D(a.C,6));
Ac(a.C,7)&&b.setOption("vAxes.0.viewWindow.min",D(a.C,7));Ac(a.C,8)&&b.setOption("vAxes.0.viewWindow.max",D(a.C,8));b.setOption("vAxes.1.title",D(a.C,9));Ac(a.C,10)&&b.setOption("vAxes.1.viewWindow.min",D(a.C,10));Ac(a.C,11)&&b.setOption("vAxes.1.viewWindow.max",D(a.C,11));b.setOption("useFirstColumnAsDomain",D(a.C,15));b.setOption("isStacked",D(a.C,17));b.setOption("treatLabelsAsText",Cb(p$b,c));b.Bh(c);d=Fc(a.C,12);if(!D(a.C,24)&&d&&d.length)if(b.setOption("applyAggregateData",0),d=Fc(a.C,13),"PieChart"===
c)b.setOption("aggregateFunction",d[0]);else for(c=0;c<d.length;c++)b.setOption("series."+c+".aggregateFunction",d[c]);b.eba(QH);c=pW(a);d=!!D(a.C,14);e=D(a.C,16)||0;d=El(i3a("/gviz/tq"),"").ib("transpose",d?"1":"0").ib("headers",e.toString()).ib("hds",0).ib("merge",d?"ROWS":"COLS").ib("authkey",um("authKey"));D(a.C,24)&&(c=[LT(D(a.C,18))],d.ib("dt",encodeURIComponent(JSON.stringify(a.Le.serialize(D(a.C,25))))));n3a(d,c);b.Ii(d.toString());a.J&&(c=d.clone(),a.J.F=c);return b}
function q$b(a){var b=z$b(a);b.setOption("legend.position","none");b.setOption("hAxis.slantedText",0);b.setOption("hAxis.textStyle.fontSize",11);b.setOption("vAxes.0.textStyle.fontSize",11);b.setOption("vAxes.1.textStyle.fontSize",11);b.setOption("fontStyle.size",10);b.setOption("fontStyle.italic",!1);b.setOption("titleTextStyle.bold",!1);b.setOption("titleTextStyle.fontSize",12);b.setOption("async",40);!1!==b.Ub("useFirstColumnAsDomain")&&b.Se()&&"number"===b.Se().$c(0)&&b.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==b.Ub("useFirstColumnAsDomain")&&b.Se()&&"string"===b.Se().$c(0)){var c=0,d=Wm("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";T(a,"waffle-assistant-card-inner").appendChild(d);for(var e=0;e<b.Se().getNumberOfRows();e++)nn(d,b.Se().zf(e,0)),c=Math.max(c,jq(d).width);cn(d);c=Math.min(27,Math.max(15,10+100*c/271))}b.setOption("chartArea.top","15%");d=b.Ub("hAxis.title");b.setOption("chartArea.height",Qa(Sa(d))?"80%":"65%");b.setOption("chartArea.left",c+"%");b.setOption("chartArea.width",
95-c+"%");"PieChart"==b.getChartType()&&(b.setOption("chartArea.top",Qa(Sa(b.Ub("title")))?"12%":"15%"),b.setOption("chartArea.height","70%"),b.setOption("chartArea.left","0%"),b.setOption("chartArea.width","100%"),b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled"),b.setOption("legend.textStyle.fontSize",10));(new mV(QH,b.Sg)).send(y(a.QVb,a,b));a.J&&r$b(a,y(function(a){var b=this.J,c=new BH(a.toJSON()),d=yq(b,"waffle-assistant-faceted-chart");1<d.length?(l$b(a),k$b(c),c.setOption("axisFontSize",
0),c.setOption("hAxis.title",null),c.setOption("hAxis.textPosition","none"),c.setOption("vAxes.0.title",null),c.setOption("vAxes.0.textPosition","none"),c.setOption("vAxes.1.title",null),c.setOption("vAxes.1.textPosition","none"),c.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"}),c.setOption("legend","none"),c.setOption("titleTextStyle.fontSize",0)):(l$b(a),a.setOption("applyAggregateData",void 0),a.setOption("legend","right"),k$b(c));var e=LT(D(b.J,18));n3a(b.F,[e]);for(var e=
D(b.J,25),g=0;g<d.length;g++){var r=za(b.L[g])?b.L[g]:null,t=e.clone(),w=t,x=b.Da,C=r,E=new jf;F(E,1,x);za(C)&&E.Wa(C);F(w,7,E);b.F.ib("dt",encodeURIComponent(JSON.stringify(b.Na.serialize(t))));t=new BH(a.toJSON());t.Ii(b.F.toString());w=c.clone();w.Ii(b.F.toString());var C=b,I=t,x=r;(E=I.Ub("title"))||(E=i9b(I));I=E+(' when "'+(C.D+('" is "'+(x+'"'))));C=E+(' by "'+(C.D+'"'));x=x?I:C;t.setOption("title",x);w.setOption("title",x);w=new h$b(t,w,0,0,b.Ka,b.O,b.oa);b.Ma(w);x=d[g];w.Va(x);b.ea.push(w);
w=b;C=i9b(t);t=C+(' broken down by "'+(w.D+('" for "'+(r+'"'))));w=C+(' broken down by "'+(w.D+'"'));Ap(x,r?t:w)}m$b(b);b.Ba.style.visibility="visible"},a),!1)}function r$b(a,b,c){var d=z$b(a);(new mV(QH,d.Sg)).send(function(a){a?(a=a.Se(),c&&d.Ef(a),AV(d,a),b(d)):b(null)})}function pW(a){a=Fc(a.D,4);for(var b=[],c=0;c<a.length;c++)b.push(LT(a[c]));return b}q.getChartType=function(){return this.C.getChartType()};
function x$b(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=L6b("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Ob(d,d);return d}function w$b(a,b){return b?g9b(a,new kh(a.width,1)):g9b(a,new kh(1,a.height))};function A$b(){uL.call(this);this.La.push(this);this.va=this.ea=!0;this.Na="waffle-assistant-dragged-card"}z(A$b,Vhb);A$b.prototype.contains=function(a){return!!A(this.J,function(b){if(b.element==a)return!0})};A$b.prototype.Eka=function(a){var b=A$b.Z.Eka.call(this,a);if(r5b()||pm){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=vb(b.querySelectorAll("clippath"),function(a){return a.id}),B$b(b,a);return b};
function B$b(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];za(c)&&cb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=en(a);for(d=0;d<a.length;d++)B$b(a[d],b)}function n$b(a,b){wL.call(this,a,b)}z(n$b,wL);n$b.prototype.Gka=f("element");function C$b(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function qW(a,b){lW.call(this,a,b);this.C=a.getAutovisRecommendation()}z(qW,lW);q=qW.prototype;q.Vy=oa;q.Px=n("assistantWordCloudFeedback");q.iE=n(2634);q.hE=n(2633);q.Sa=function(){qW.Z.Sa.call(this);mW(this).appendChild(Or(C$b));Dp(mW(this),"waffle-assistant-word-cloud-content-container")};
q.cz=function(a){for(var b=Fc(this.C,19),c=Fc(this.C,20),d=T(this,"waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Kk(b,c,e),120<d.clientHeight){this.Kk(b,c,e-1);break}b=this.oa;c=D(this.C,2);c=Bn(b,c);d=T(this,"waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Kk=function(a,b,c){for(var d=T(this,"waffle-assistant-word-cloud-words-container"),e=this.oa;d.firstChild;)d.removeChild(d.firstChild);for(var g=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(Bn(e," "));var l=e.createElement("SPAN");e.appendChild(l,Bn(e,a[k]));e.appendChild(d,l);Dp(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-g)/(h-g)*15+9+"px"}};function rW(a,b,c,d,e){WV.call(this,20,d,c,e);this.ea=a;this.$=b;this.C=new A$b;H(this,this.C);this.F=null;this.Y=0}z(rW,WV);q=rW.prototype;q.Ha=function(){rW.Z.Ha.call(this);this.C.We();this.getHandler().V(this.C,"drag",this.KVb).V(this.C,"dragend",this.JVb)};q.yT=n("Analysis");q.a4=function(a){return 0==a};q.uW=function(a){return"WordCloud"==a.getAutovisRecommendation().getChartType()?new qW(a,this.oa):new nW(a,this.ea,this.$,this.O,this.C,this.oa)};q.t1=function(a){rW.Z.t1.call(this,a);a&&Dhb(this.C)};
q.IIa=function(a){Gf(this.getHandler(),a,"content-rendered",this.IVb);this.Y++};q.IVb=function(){0==--this.Y&&this.dispatchEvent("assistant-done-rendering")};q.KVb=function(){this.F=Yp(this.C.Xc.target)};q.JVb=function(a){var b=this.F,c=fA(this.$).C;if(ph(tE(c,"page",!1,!1)).contains(b)){var d=rE(c,b.x,b.y,"page"),c=vE(c,vh(d),"page"),b=new N(b.x-c.left,b.y-c.top);a.C.getData().B8(d,b)}this.F=null};q.Mca=n(2);function sW(a,b,c,d){this.C=a;this.hfa=b;this.Ln=(this.F=c)?D(c,2):null;this.L=c?Fc(c,6):[];this.O=c?Fc(c,7):[];this.J=c?Fc(c,8):[];this.error=d||1;this.interpretation=loa&&c&&Ac(c,4)?D(c,4):null;this.D=moa&&c?Fc(c,12):[]}function D$b(a){return{rS:E$b(a),interpretation:a.interpretation,hfa:a.hfa,Ln:a.Ln}}function F$b(a){return{rS:E$b(a),error:G$b(a)}}
function G$b(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer. Please try again.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about you data.";case 6:return a.F.getError().xl()||""}return""}
function E$b(a){var b=[];if(koa&&1==a.error&&null!=a.Ln){var c=[];A(Lb(a.L,a.J),function(a){c.push(H$b(a,"waffle-assistant-answercard-question-unused-phrase"))},a);A(a.O,function(a){c.push(H$b(a,"waffle-assistant-answercard-question-used-entity"))},a);Ub(c,function(a,b){return a.QB>b.QB?1:-1});var d=0;A(c,function(a){a.QB>d&&b.push({text:this.C.substring(d,a.QB),className:null});d=a.QB+a.length;b.push({text:this.C.substring(a.QB,d),className:a.vk})},a);d<a.C.length&&b.push({text:a.C.substring(d),
className:null})}else b.push({text:a.C,className:null});return b}function H$b(a,b){return{QB:D(a,2),length:D(a,3),vk:b}};function tW(a,b,c,d){L.call(this);this.X=a;this.Y=b;this.$=c;this.La=d;this.qa=new M(this);H(this,this.qa);this.C=new EU;H(this,this.C);this.R="";this.O=[];this.F=this.D=this.L=null;this.J=!1;P5b(this.C,this.X);this.C.X=10;this.C.ea=!0;this.C.L=!1;this.C.cra("waffle-assistant-visible");this.C.R=Xa("waffle-assistant-dragged-formula").split(" ");this.C.We();this.qa.V(this.C,"beforedragstart",this.ea).V(this.C,"dragmove",this.Ga).V(this.C,"beforedragend",this.va)}z(tW,L);
tW.prototype.ea=function(a){a=sb(this.X.childNodes,a.C);this.R=this.O[a]};
tW.prototype.Ga=function(a){var b=a.event instanceof uq?a.event.C:a.event;this.J?(a.Y.gw(b,!0),a.preventDefault()):(Qp(a.F,a.event.clientX,a.event.clientY),a=Rp(a.F),b=fA(this.Y).C,ph(tE(b,"page",!1,!1)).contains(a)?(a=rE(b,a.x,a.y,"page"),(b=ex(xw(this.$),a.y,a.x))?a=new N(b.bc(),b.jc()):b=vh(a),this.L=a,this.D&&this.D.Ac().equals(b)||(a=fA(this.Y),J(this.D),this.D=OT(a,b,"waffle-assistant-formula-insertion-rect"),H(this,this.D),AF(lI(a),this.D),J(this.F),this.F=SH(a,b,"waffle-assistant-formula-insertion-border",
2,0),H(this,this.F),PXa(this.F,"#000"),this.F.setVisible(!0))):I$b(this))};tW.prototype.va=function(a){if(this.L){var b=this.L,c=xw(this.$),b=new LE(c,b,this.R);this.La.C(b);this.dispatchEvent(new K("formula_inserted"))}a.Y.gw(null,!0);a.preventDefault();this.R="";I$b(this)};function I$b(a){a.L=null;J(a.D);a.D=null;J(a.F);a.F=null};function J$b(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+K$b({rS:a.I3.rS}),d;d=a.I3.hfa;var e=a.I3.Ln;a=a.I3.interpretation;null==d||ta(d);a=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+ns("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(a?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(a)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){a+='<div class="waffle-assistant-answercard-answer">';for(var g=d.length,h=0;h<g;h++){var k=d[h],l=1<k.length;if(0==h&&l){a+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=k.length,m=0;m<l;m++)a+='<span class="waffle-assistant-answercard-answer-col">'+U(k[m])+"</span>"}else for(l="waffle-assistant-answercard-answer-row"+(l?" waffle-assistant-answercard-answer-list-row":""),l=js(l),a+=
'<div class="'+W(l)+'">',l=k.length,m=0;m<l;m++){var p=k[m];a=p?a+('<span class="waffle-assistant-answercard-answer-col">'+U(p)+"</span>"):a+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}a+="</div>"}a+="</div>"}a+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+
U(Pu({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+U(e)+"</div></div></div></div></div></div>";d=V(a);return b(c+d+"</div></div>")}
function K$b(a){a=a.rS;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+ns("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function L$b(){return V(U(V('<div class="waffle-assistant-answers-card-remove">'+U(Pu({icon:"docs-icon-img docs-icon-trash"}))+"</div>")))};var M$b="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this".split(";");function N$b(a,b,c,d){K.call(this,"sqc");this.F=a;this.C=d||"";this.Y=c}z(N$b,K);function uW(a,b,c,d,e,g,h,k){lW.call(this,new gW,k);this.L=a;this.Da=b;this.Ua=c;this.Na=d;this.Za=g;this.ea=e;this.Ka=h;this.Tc=Wo(new Vo,10).Fa();this.R=new lt("",new jW,this.oa);this.Ma(this.R);this.C=null;this.J=new lt("",new iW,this.oa);this.Ma(this.J);this.O=new lt("",new iW,this.oa);this.Ma(this.O)}z(uW,lW);q=uW.prototype;q.mja=f("Ka");q.Sa=function(){uW.Z.Sa.call(this);b$b(this).appendChild(Or(L$b))};
q.Ha=function(){uW.Z.Ha.call(this);var a=T(this,"waffle-assistant-answers-card-remove");this.R.Va(a);TV(a,"Remove card",0);Gf(this.getHandler(),this.R,"action",this.YVb).V(this.J,"action",this.Fxb).V(this.O,"action",this.ipb)};
q.cz=function(a){mW(this).appendChild(Or(J$b,{I3:D$b(this.L)}));this.J.Va(T(this,"waffle-assistant-answercard-see-formula-link"));this.O.Va(T(this,"waffle-assistant-answercard-hide-formula-link"));this.C=new tW(T(this,"waffle-assistant-answercard-formula-text-container"),this.Da,this.Ua,this.Na);var b=this.Id();this.C.J=b;this.C.O=[this.L.Ln];H(this,this.C);b=T(this,"waffle-assistant-answercard-formula-text");Ap(b,"Formula: "+(this.L.Ln+". Click/Press ENTER to copy or drag to insert on to sheet."));
If(this.getHandler().V(this.C,"formula_inserted",this.XVb),T(this,"waffle-assistant-answercard-formula-text"),nd,this.Aob);O$b(this,!1);a()};q.Vy=function(){Ap(this.Ba,"Answer Card for question: "+this.L.C)};q.xT=Lf;q.Px=n("assistantAnswersFeedback");q.iE=n(2628);q.hE=n(2627);q.w7=n("Was this answer correct?");q.kka=n("Correct");q.jka=n("Incorrect");q.w6=f("L");q.DG=function(a){uW.Z.DG.call(this,a);this.C&&(this.C.J=a)};
function O$b(a,b){a.J.setVisible(!b);a.O.setVisible(b);R(T(a,"waffle-assistant-answercard-formula"),b);b?T(a,"waffle-assistant-answercard-formula-text").focus():(a.J.Ba.focus(),a.J.Iq(!0))}q.YVb=function(){var a=new RV;P(a,3,!0);var b=new RT;fj(b,4,a);a=new io;fj(a,46,b);this.ea.Pb(2753,new Uo(10,a));this.dispatchEvent(new K("rc"))};q.Fxb=function(){O$b(this,!0)};q.ipb=function(){O$b(this,!1)};q.XVb=function(){this.ea.Pb(2709,this.Tc)};
q.Aob=function(){var a=this.oa.yb(),b=a.createElement("textarea");b.textContent=this.L.Ln;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&P$b(this.Za,"Formula copied to clipboard",this.oa)};function Q$b(a,b,c){c=c||{};a=js("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(Pu({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display:none"></div></div></form></div>';return V(a)};function R$b(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(K$b({rS:a.OEa.rS})),d;d=a.OEa.error;var e=!!a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(Pu({icon:"docs-icon-img docs-icon-alert"}))+'</div><div class="waffle-assistant-errorcard-content">';e?(d=U(d)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+
d+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(d)+"</div>";d=V(a+"</div></div>");return b(c+d+"</div></div>")}function S$b(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function vW(a,b,c,d,e){lW.call(this,new gW,e);this.O=a;this.ea=b;this.L=d;this.Da=c;this.R=new lt("",new jW,this.oa);this.Ma(this.R);this.J=new lt("",new iW,this.oa);this.Ma(this.J);this.C=new lt("",new iW,this.oa);this.Ma(this.C)}z(vW,lW);q=vW.prototype;q.Vy=function(){Ap(this.Ba,"Error Card for question: "+this.O.C)};q.Px=n("assistantAnswersFeedback");q.xT=Lf;q.c9=Kf;q.Sa=function(){vW.Z.Sa.call(this);b$b(this).appendChild(Or(L$b))};
q.Ha=function(){vW.Z.Ha.call(this);var a=T(this,"waffle-assistant-answers-card-remove");this.R.Va(a);this.C.setVisible(this.L);TV(a,"Remove card",0);Gf(Gf(this.getHandler(),this.R,"action",this.bWb),this.J,"action",this.Sxb).V(this.C,"action",this.epb)};
q.cz=function(a){mW(this).appendChild(Or(R$b,{OEa:F$b(this.O),showHelp:this.L}));if(fm){var b=Or(S$b);this.oa.appendChild(this.Ba,b);this.J.Va(T(this,"waffle-assistant-answercard-feedback-link"))}this.L&&this.C.Va(T(this,"waffle-assistant-answers-helpcenter-link"));a()};q.mja=f("ea");q.w6=f("O");q.Sxb=function(){this.J.setVisible(!1);R(T(this,"waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new K("trigger_feedback"))};
q.bWb=function(){var a=new RV;P(a,3,!1);var b=new RT;fj(b,4,a);a=new io;fj(a,46,b);this.Da.Pb(2753,new Uo(10,a));this.dispatchEvent(new K("rc"))};q.epb=function(){Q.Hm.Wb()};function T$b(a){lW.call(this,new gW,a);this.C=this.oa.createElement("div");nn(this.C,"Previous")}z(T$b,lW);q=T$b.prototype;q.Vy=function(){Ap(this.Ba,"Previous questions below")};q.Sa=function(){T$b.Z.Sa.call(this);Fp(this.Ba,"waffle-assistant-card");Dp(this.Ba,"waffle-assistant-answers-previousheadercard")};q.cz=function(a){0<this.oa.Ah(mW(this)).length||mW(this).appendChild(this.C);a()};q.c9=Kf;q.Px=n("assistantAnswersFeedback");function U$b(a){var b;b=""+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":"");var c;c=js("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.rPb;for(var d=a.length,e=0;e<d;e++){var g=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(Pu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+
U(g)+"</div></div></div>"}return V(b+"</div>")};function wW(a,b,c,d,e){lW.call(this,a,e);this.J=c;this.C=d;this.L=b}z(wW,lW);q=wW.prototype;q.iE=function(){return Cb([V$b,W$b],this.C)?2799:Cb([X$b,Y$b],this.C)?2801:null};q.hE=function(){return Cb([V$b,W$b],this.C)?2798:Cb([X$b,Y$b],this.C)?2800:null};q.w7=n("Were these interesting?");q.kka=n("Interesting");q.jka=n("Not interesting");q.Px=n("assistantAnswersFeedback");q.Vy=function(){var a=this.C.title;a&&this.J?Ap(this.Ba,a+(" for question : "+this.J)):Ap(this.Ba,"Suggested questions")};
q.cz=function(a){this.L.then(function(b){var c=this.oa,d=mW(this);if(0==c.Ah(d).length){var e=Or(U$b,{title:this.C.title,rPb:vb(b,function(a){return a.query})});d.appendChild(e);d=yq(this,"waffle-assistant-answercard-question-container");A(d,function(a,d){var e=new lt("",new jW,c);this.Ma(e);e.Va(a);this.getHandler().V(e,"action",y(this.wzb,this,b[d]))},this)}a()},null,this)};q.wzb=function(a){this.dispatchEvent(new N$b(this.C.H0,0,a.Ln||null,a.query))};
var Z$b={title:"",H0:null},V$b={title:"",H0:1},W$b={title:"Suggested questions",H0:1},Y$b={title:"Did you mean?",H0:4},X$b={title:"Related questions",H0:4};function xW(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var g;do g=Math.floor(Math.random()*a);while(d[g]);d[g]=1;c.push(g)}else{for(e=0;e<a;e++)c.push(e);for(e=0;e<b;e++)d=Math.floor(Math.random()*(a-e)+e),g=c[e],c[e]=c[d],c[d]=g}return c.slice(0,b)};function $$b(a){this.J=[];this.D={};this.L=a;this.C=new wP}function aac(a,b,c,d){function e(a){return a.toLowerCase()}Rb(b,void 0,e);Rb(c,void 0,e);Rb(d,void 0,e);A(b,a.F,a);A(c,a.F,a);A(d,a.F,a)}$$b.prototype.F=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,g=b.substr(d),h=this.C.get(g);h||(h=[],this.C.add(g,h));h.push(e)}};
$$b.prototype.SF=function(a,b,c){var d;if(Xa(a||"")){d=this.L.Ol();d=bac(this,a.substring(0,d));var e=cac(this,b-d.length,a);d=Lb(d,e)}else d=cac(this,b);d.length>b&&(d=Pb(d,0,b));c(a,d)};function cac(a,b,c){var d=c||"";c=cc(a.D,function(a){return Ma(a,d)});var e=dac(hc(c),d?1:2,1);a=ub(a.J,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=dac(a,b-gc(e),2);return Lb(hc(b),hc(e))}
function bac(a,b){for(var c=[],d=3,e={},g=b.toLowerCase(),h=0;h<g.length&&0<d;++h)if(0==h||" "==g[h-1]&&" "!=g[h]){var k={},l=0,m=g.substr(h),p=a.C.xe(m);A(p,function(a){var b=a.length-m.length;l=Math.max(b,l);a=this.C.get(a);k[b]||(k[b]=[]);Ob(k[b],a)},a);for(p=0;p<=l&&0<d;++p){var r=k[p];if(r)for(var t=0;t<r.length&&0<d;++t){var w=r[t];cb(b.toLowerCase(),w.toLowerCase())||e[w]||(--d,c.push({text:w,Ln:"",Qy:0,QAa:g.length-h}),e[w]=!0)}}}return c}
function dac(a,b,c){b=xW(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=za(b)?b:b.query;d[e.toLowerCase()]={text:e,Ln:za(b)?"":b.Ln,Qy:c,QAa:0}});return d};function yW(){pF.call(this,"",null,!1)}z(yW,pF);yW.prototype.wB=function(a,b){if(2==a.Qy||1==a.Qy)return yW.Z.wB.call(this,a.text,b);var c=this.Ia(),d=this.Ol(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var g=c.substring(0,d-a.QAa)+a.text;e||(g+=" ");a=yW.Z.wB.call(this,{toString:function(){return g+c.substring(d)}},b);this.f0(g.length);b=this.Aj;b.blur();b.focus();return a};
yW.prototype.Hg=function(a){var b=yW.Z.Hg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,AWa(b)&&b.tE()&&a.preventDefault(),b=!0);return b};function eac(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(Pu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(Pu({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(Pu({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function fac(a){this.C=a||Jm()}
fac.prototype.XK=function(a,b,c){b=Or(eac);var d=yn(this.C,"waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.C.Nf(d,a.text);var d=yn(this.C,"waffle-assistant-answers-ac-entity-icon",b),e=yn(this.C,"waffle-assistant-answers-ac-suggested-query-icon",b),g=yn(this.C,"waffle-assistant-answers-ac-session-query-icon",b);R(d,0==a.Qy);R(e,2==a.Qy);R(g,1==a.Qy);d="";switch(a.Qy){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Dp(c,d);this.C.appendChild(c,b)};function zW(a,b,c,d,e,g,h,k,l){UV.call(this,l);this.Le=c;this.Ej=d;this.Ei=e;this.Gf=a;this.mb=h;this.Da=this.R=this.F=this.bb=null;this.ea=new yW;this.ea.DFa=!0;this.ea.ea=!0;this.Ka=new $$b(this.ea);a=new nF(null,new fac(l));this.L=new iF(this.Ka,a,this.ea);H(this,this.L);this.J=g;this.Y=null;this.oh=k;this.Xa=!1;this.Tc=Wo(new Vo,10).Fa();this.Si=new Li;this.Na={};this.X=this.C=this.Qb=null;this.Qc=[];this.qc=[];this.$e=wJ.getInstance();this.Za=""}z(zW,UV);q=zW.prototype;
q.Sa=function(){zW.Z.Sa.call(this);var a=this.L.Re();a.className="waffle-assistant-answers-ac-renderer";a.Ci="waffle-assistant-answers-ac-row";a.nt="waffle-assistant-answers-ac-active";a.JH="waffle-assistant-answers-ac-highlighted"};q.Ha=function(){zW.Z.Ha.call(this);this.ea.C=this.L;this.L.S3=!1;this.L.p$=6;this.getHandler().V(this.L,"update",this.Xhb);this.nL(null==this.Y)};
q.wqa=function(a,b){zW.Z.wqa.call(this,a,b);b=this.oa;var c=this.$;b.appendChild(a,Or(Q$b));this.X=yn(b,"waffle-assistant-answers-query-box",a);this.F=new lt("",new jW,this.oa);c.Ma(this.F);this.F.Va(yn(b,"waffle-assistant-answers-clear-query-button",this.X));this.Da=new KV(!1,"#4285f4");c.Ma(this.Da);this.Qb=yn(b,"waffle-assistant-answers-spinner-container",this.X);this.Da.render(this.Qb);this.C=yn(b,"waffle-assistant-answers-input-box",this.X);PWa(this.ea,this.C);TV(this.F.getElement(),"Clear query");
c.getHandler().V(this.X,"submit",y(this.szb,this)).V(this.X,"focus",y(this.JEa,this,!0),!0).V(this.X,"blur",y(this.JEa,this,!1),!0).V(this.F,"action",y(this.o3a,this)).V(this.C,"input",y(this.zQb,this)).V(this.C,"focus",y(this.gMb,this));this.F.setVisible(!1)};q.Z4=function(){RWa(this.ea,this.C);this.F.setVisible(!1);this.Da.dispose();this.Da=null;zW.Z.Z4.call(this)};q.nL=function(a){zW.Z.nL.call(this,a);this.C&&(a?this.C.setAttribute("disabled",!0):this.C.removeAttribute("disabled"))};q.lh=ea("bb");
function gac(a,b,c){var d=vb(Fc(c,1),function(a){return a.getName()}),e=[],g=[];A(Fc(c,2),function(a){e.push(a.getName());g=g.concat(Fc(a,2))});aac(a.Ka,d,e,g);hac(a.Gf).then(function(a){this.Ka.J=a},null,a);a.Y=b;a.nL(null==b)}q.reset=function(){nU(this.Na);nU(this.Ka.D);this.R=null};
function iac(a){if(a.rc()&&(jac(a),null!=a.Y))for(var b=fA(a.Le),c=b.ud(),c=vb(hc(Yg),c.q1,c),c=vb(c,Fa(xh,a.Y.rect)),d=0;d<c.length;d++)if(c[d]&&Jh(c[d])){var e=OT(b,c[d],"waffle-assistant-answers-styled-rect");H(a,e);AF(lI(b),e,!0);e.setVisible(!0);a.Qc.push(e);e=SH(b,c[d],"waffle-assistant-answers-styled-border",1,0);H(a,e);e.setVisible(!0);a.qc.push(e)}}function jac(a){Kc(a.Qc);Kc(a.qc);a.Qc=[];a.qc=[]}
q.Xhb=function(a){a.row&&(a=a.row,2==a.Qy?(kac(this,1,a.Ln),this.J.Pb(2652,this.Tc)):0==a.Qy?(this.Xa=!0,this.J.Pb(2651,this.Tc)):1==a.Qy&&kac(this,3))};q.JEa=function(a){Hp(this.X,"waffle-assistant-answers-query-box-focused",a);kF(this.L)&&!a&&this.L.uj()};q.zQb=function(){this.F.setVisible(!!k9b(this.C))};q.gMb=function(){var a=Sa(k9b(this.C));this.ea.f0(a.length);xWa(this.L,a||"  ");this.L.update(!0)};
function kac(a,b,c){var d=Xa(k9b(a.C));if(!a.bb||3<=a.bb.getStatus().getState().C)d=new sW(d,null,null,2),lac(a,d,!1);else{if(d&&a.Y)if(a.Na[d])a.J.Pb(2681,a.Tc),c=a.Na[d],c!=rb(a.D)&&(1<a.D.length&&(mac(a),nac(a)),oac(a,c.w6()),x9b(a,c));else{var e=pac(),g=dj(dj(e,RT,46),RV,4);P(g,2,a.Xa);a.J.Pb(2635,new Uo(10,e));a.Xa=!1;e=Ow(a.Y.rect);b=Xk(rj(Yk(tj(uj(a.bb.Cf("/answers/parse").Ff("q",d,"qt",b,"gid",a.Y.vd,"range",e),y(a.Rj,a,d,b)),y(a.ZVb,a,d,b)),"POST"),2));c&&b.Ff("sgfml",c);b.Te();a.Za=xJ(a.$e,
lj.oua);qac(a,!0)}else j9b(a.C,"");a.C.blur();a.F.setVisible(!!d);kF(a.L)&&a.L.uj()}}q.szb=function(a){a.stopPropagation();a.preventDefault();kac(this,2)};q.o3a=function(){j9b(this.C,"");this.F.setVisible(!1)};q.ZVb=function(a,b){var c=pac(),d=dj(dj(c,RT,46),RV,4);P(d,1,1==b||4==b?m9b.Nya:m9b.mza);this.J.Pb(2640,new Uo(10,c));rac(this,a)};function rac(a,b){qac(a,!1);b=new sW(b,null,null,3);lac(a,b,!1);sac(a)}
q.Rj=function(a,b,c){var d=null,e=null,g=!1,h=pac(),k=dj(dj(h,RT,46),RV,4);P(k,1,1==b||4==b?m9b.Nya:m9b.mza);b=new Uo(10,h);if(c.$k()){e=this.Si.od(ZV.Ca(),c.Mf());if(g=e.getStatus()){var l;switch(g){case 1:l=2639;break;case 2:l=2643;break;case 3:l=2644;break;case 4:l=2638;break;case 5:l=2707;break;case 6:l=2706}l&&this.J.Pb(l,b)}if(1==g){rac(this,a);return}if(2==g){e=-1!=tac(a);a=new sW(a,null,null,e?5:4);e?(e=new vW(a,!0,this.J,!0,this.oa),uac(this,a,e)):lac(this,a,!0);qac(this,!1);sac(this);return}l=
e.hasFormula()?D(e,2):null;c=Ac(e,9)?e.getError().xl():null;g=!0;l?((d=vac(this.oh,l,this.Y))||this.J.Pb(2645,b),d=new sW(a,d,e,null)):c&&(d=new sW(a,null,e||null,6))}else this.J.Pb(2640,b);d||(d=new sW(a,null,e||null,4));qac(this,!1);1==d.error&&null!=d.Ln?wac(this,d,g):lac(this,d,g);sac(this)};function sac(a){""!=a.Za&&(yJ(a.$e,a.Za),a.Za="")}function xac(a){if(null!=a.Ln)return X$b;switch(a.error){case 4:return 0<a.D.length?Y$b:W$b;case 5:return W$b;case 6:return Y$b}return Z$b}
function pac(){var a=new RV,b=new RT;fj(b,4,a);a=new io;fj(a,46,b);return a}function tac(a){return Ab(M$b,function(b){return Ma(a,b)})}function yac(a){var b=[];a=a.D;0<a.length&&(a=Pb(a,0,3),b=vb(a,function(a){return{query:D(a,1),Ln:D(a,2),type:a.getType()}}));return Ej(b)}function wac(a,b,c){c=new uW(b,a.Le,a.Ej,a.Ei,a.J,a.mb,c,a.oa);uac(a,b,c)}function lac(a,b,c){c=new vW(b,c,a.J,!1,a.oa);uac(a,b,c)}
function uac(a,b,c){mac(a);nac(a);oac(a,b);zac(a,c);for(var d=a.D;5<d.length;)a.WK(d[0]);if(1==b.error&&null!=b.Ln){var d=a.Ka,e=b.C;d.D[e.toLowerCase()]||(d.D[e.toLowerCase()]=e)}c.mja()&&(a.Na[b.C]=c);a.getHandler().V(c,"rc",a.owb)}function nac(a){0!=a.D.length&&(a.R?x9b(a,a.R):(a.R=new T$b(a.oa),zac(a,a.R)))}function mac(a){A(a.D,function(a){a instanceof uW||a instanceof vW||a==this.R||this.WK(a)},a)}
function oac(a,b){var c=xac(b),d=null;c==X$b||c==Y$b?0<b.D.length&&(d=yac(b)):c==W$b&&(d=Aac(a.Gf));d&&(c=new wW(new gW,d,b.C,c,a.oa),zac(a,c),a.J.Pb(2769,a.Tc),a.getHandler().V(c,"sqc",y(a.vzb,a,b)))}q.vzb=function(a,b){j9b(this.C,b.C);this.C.focus();kac(this,b.F,b.Y);this.J.Pb(2762,this.Tc)};function qac(a,b){R(a.Qb,b);R(yn(a.oa,"waffle-assistant-answers-button-container",a.X),!b);a.Da&&a.Da.setActive(b)}function zac(a,b){b.DG(a.Id());a.D.push(b);a.Wc&&(a.O.wi(b,0,!0),b.sO());VV(b,!0)}
q.j4=function(){zW.Z.j4.call(this);this.reset()};q.owb=function(a){var b=this.oa;a=a.target;a instanceof uW?(this.WK(a),P$b(this.mb,"Answer removed",b,y(this.pwb,this,a))):a instanceof vW&&(this.WK(a),P$b(this.mb,"Card removed",b));b=this.D;!this.R||b[0]!=this.R&&b[b.length-1]!=this.R||(this.WK(this.R),this.R=null)};q.pwb=function(a){wac(this,a.w6(),a.mja());P$b(this.mb,"Remove answer undone",this.oa)};
q.WK=function(a){if(a.rc()){if(a instanceof uW||a instanceof vW)delete this.Na[a.w6().C],a==rb(this.D)&&mac(this);zW.Z.WK.call(this,a)}J(a)};function Bac(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(Pu({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+ns("Ask a question about your data")+'" /></div></form></div>');return V(a)};function Cac(a,b){this.C=a;this.D=b}function vac(a,b,c){var d=rw(a.D),d=null!=d?d.toString():"0",e=0,g=0;ritz.getActiveFilterId(d)&&(c=c.rect,ritz.getNumberOfRows(d)>c.Uc()+1?e=c.Uc()+1:ritz.getNumberOfColumns(d)>c.bd()+1&&(g=c.bd()+1));return f9b(a.C,b,d,e,g)};function Dac(a){var b=[];if(Ac(a,25)&&(a=D(a,25)))for(var c=0;c<Bc(a,1);c++){var d=D(a,1,c);if(Ac(d,2)){var e=D(d,2);e&&b.push(Eac(e,Fac(d)))}}return b}function Fac(a){return(a=Ac(a,4)?D(a,4):0)?a:0}function Eac(a,b){return{name:a,Hza:b}};function Gac(a){this.C=a;for(var b=new jg,c=0;c<Bc(a,2);c++)b.set(a.$d(c).getName().toLowerCase(),c);this.O=b;b=new jg;for(c=0;c<Bc(a,1);c++)b.set(D(a,1,c).getName().toLowerCase(),c);this.$=b;b=[];for(c=0;c<Bc(a,2);c++)AW(a.$d(c).getName())&&b.push(c);this.D=b;b=[];for(c=0;c<Bc(a,1);c++)AW(D(a,1,c).getName())&&b.push(c);this.J=b;b=[];for(c=0;c<Bc(a,1);c++){for(var d=D(a,1,c).getName(),e=!0,g=0;g<Hac.length;g++)if(-1!=d.search(new RegExp("(\\b|_)"+Hac[g]+"(\\b|_)","i"))){e=!1;break}e&&b.push(c)}this.Ga=
b;this.Y=Iac(a,0);this.R=Iac(a,1);b=[];for(c=0;c<Bc(a,2);c++).8<=D(a.$d(c),6)&&b.push(c);this.X=b;this.F=[];this.L=[];this.va=Jac(Bc(a,2));this.ea=Jac(Bc(a,1))}function Jac(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function Iac(a,b){for(var c=[],d=0;d<Bc(a,2);d++)a.$d(d).getType()==b&&c.push(d);return c}
function Kac(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Lac(c,a[d]);for(d=0;d<b.length;d++)c=Mac(c,b[d]);return 0<c.length?c[xW(c.length,1)[0]]:-1}function Nac(a,b,c){var d=[a.D,a.F],e=[a.va];b&&e.push(a.Y);c&&e.push(a.X);return Kac(e,d)}function BW(a,b){var c=[a.J,a.L],d=[a.ea];b&&d.push(a.Ga);return Kac(d,c)}function Oac(a){var b=[a.D,a.F],c=[Fc(a.C,3)];c.push(a.Y);c.push(a.X);return Kac(c,b)}
function Pac(a,b){for(var c=5;;){var d=a.C.$d(b),e=xW(Bc(d,2),1)[0];c--;if(AW(D(d,2,e))||0==c)return e}}function CW(a,b){b=a.C.$d(b);a=b.getName();AW(a)||(b=Qac(Fc(b,7)),a=null==b?a:b);return a}function DW(a,b){b=D(a.C,1,b);a=b.getName();AW(a)||(b=Qac(Fc(b,2)),a=null==b?a:b);return a}function Qac(a){for(var b=0;b<a.length;b++)if(AW(a[b]))return a[b];return null}function AW(a){return null==a?!1:50>=a.length}function Rac(a){for(var b=xW(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}
function Lac(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}function Mac(a,b){b=Lac(a,b);return 0<b.length?b:a}var Hac=["average","total","sum","mean","median"];function Sac(a){this.C=[];this.F=[];this.J=this.L=this.D=null;this.R=new rg;this.O=new rg;this.X=a}Sac.prototype.reset=function(){this.C=[];this.F=[];this.D&&(this.D.cancel(),this.D=null);this.O=new rg;this.R=new rg};Sac.prototype.lh=ea("J");function hac(a,b){if(noa)return a.D.then(function(){var a=this.F.slice();b||p9b(a);return a},null,a);a=a.C.slice();b||p9b(a);return Ej(a)}
function Tac(a){if(!a.C)throw Error("Suggestions not generated. Must call generate() at the top level");return 0<a.C.length?a.C[0].query:""}function EW(a,b,c,d){a.O.contains(c)||(b.push({query:c,Ln:void 0,type:d}),a.R.add(d),a.O.add(c))}function FW(a,b){return!a.R.contains(b)}function Aac(a){return hac(a,ooa).then(function(a){return 3>=a.length?a:Pb(a,0,3)},null,a)}function Uac(a,b){var c=[];b=Dac(b);for(var d=0;d<b.length&&-1!=a.$.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}
function Vac(a){switch(a){case 6:return"Sum";case 1:return"Average";case 4:return"Count"}return null}function GW(a){return a[xW(a.length,1)[0]]}
function Wac(a){var b=null;a.D=new Cj(function(a){if(!this.J||3<=this.J.getStatus().getState().C)this.F=this.C,a();var c=Ow(this.L.rect),e=vb(this.C,function(a){return a.query});b=Yk(Xk(rj(tj(uj(this.J.Cf("/answers/parsesuggestions").Ff("gid",this.L.vd,"range",c),y(function(b){var c=[];if(b.$k()){b=b.Mf();for(var d=0;d<b.length;d++){var e;if(e=b[d])a:{if(e=vac(this.X,b[d],this.L))for(var g=1<e.length?1:0;g<e.length;g++){for(var p=!1,r=e[g],t=0;t<r.length;t++)if(!r[t]){p=!0;break}if(!p){e=!0;break a}}e=
!1}e&&(this.C[d].Ln=b[d],c.push(this.C[d]))}}this.F=c;a()},this)),y(function(){this.F=this.C;a()},this)).setContent(["queries",Xi(e)]).setTimeout(2E3),1)),"POST").Te()},a);Jj(a.D,function(){b&&b.dispose()})}var Xac="Minimum Maximum Most Least Highest Lowest".split(" "),Yac=["Average","Total","Sum"],Zac=["before","after"];function HW(a,b,c,d,e,g,h){WV.call(this,1,g,e,h);this.Za=c;this.ea=null;this.Y=new lt("",new iW,this.oa);this.Ma(this.Y);this.$=new lt("",new iW,this.oa);this.Ma(this.$);a=new Okb(a,!0,!0);a=new Cac(a,c);this.L=new Sac(a);this.C=new zW(this.L,0,b,c,d,e,this.Xa,a,h);this.F=this.Da=null;this.Tc=Wo(new Vo,10).Fa()}z(HW,WV);
var $ac={TYa:"waffle-assistant-answers-input-box",g_a:"waffle-assistant-answers-query-box",Kic:"waffle-assistant-answers-query-box-focused",cZa:"waffle-assistant-answers-learn-more",Pec:"waffle-assistant-answers-logging-message-container",JZa:"waffle-assistant-answers-logging-opt-out"};q=HW.prototype;q.Sa=function(){HW.Z.Sa.call(this);var a=Or(Bac);this.oa.appendChild(z9b(this),a)};
q.Ha=function(){HW.Z.Ha.call(this);var a=T(this,$ac.g_a),b=T(this,$ac.TYa);this.$.Va(T(this,$ac.JZa));this.Y.Va(T(this,$ac.cZa));this.getHandler().V(a,"focus",this.Bvb,!0).V(a,"blur",this.zvb,!0).V(a,"mouseover",this.Dvb).V(a,"mouseout",this.Cvb).V(a,"click",this.Avb).V(b,"input",this.$Vb).V(this.$,"action",this.Ztb).V(this.Y,"action",this.Rqb).V(vw(this.Za),"Ib",o9b(this.aWb,25,this));this.setVisible(null!=this.Da);abc(this)};q.OSa=Kf;q.ELa=Lf;q.Lra=Kf;q.yT=n("Answers");q.Mca=n(1);
q.a4=function(a){return 3==a||0==a};q.Nta=function(a,b){Ub(a,function(a,b){return b.xS()-a.xS()});for(var c=[],d=null,e=0;e<a.length;e++){var g=Gc(a[e],1);3==g?d=a[e]:0==g&&c.push(a[e].getAutovisRecommendation())}d&&d.xS()?(e=b||null,0<Bc(d,4)?bbc(this,LT(d.mJ()),D(d,9),c):bbc(this,e,D(d,9),c),this.F||(HW.Z.Nta.call(this,a,b),this.getHandler().V(this.F,"sqc",this.uzb))):this.s1(!0)};q.uW=function(a){if(!this.F){var b=Aac(this.L);this.F=new wW(a,b,"",V$b,this.oa)}return this.F};q.NBa=f("C");
q.Pma=function(){return this.Ta()};q.s1=function(a,b,c){this.L.reset();(a||b)&&this.F&&(HW.Z.s1.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(HW.Z.s1.call(this,a,b,c),this.F.dispose(),this.F=null),this.rc()&&(this.L.reset(),this.Da=null,a=this.C,a.rc()&&(b=a.Ka,b.J=[],b.C.clear(),a.C&&j9b(a.C),a.j4(),a.Y=null,a.nL(!0),a.F&&!a.F.isDisposed()&&a.F.setVisible(!1),a.Xa=!1),this.setVisible(!1),this.Ob()&&jac(this.C));c&&this.C.reset()};q.lh=function(a){this.ea=a;this.C.lh(a);this.L.lh(a)};
q.setActive=function(a){HW.Z.setActive.call(this,a);a?iac(this.C):jac(this.C)};function abc(a){R(T(a,"waffle-assistant-answers-logging-message-container"),!1)}function cbc(a,b){a=T(a,"waffle-assistant-answers-query-box");Hp(a,"waffle-assistant-answers-query-box-focused",b)}q.aWb=function(){this.Ob()&&iac(this.C)};q.Bvb=function(){cbc(this,!0);iac(this.C)};q.zvb=function(){cbc(this,!1);this.Ob()||jac(this.C)};q.Dvb=function(){iac(this.C)};q.Cvb=function(){this.Ob()||jac(this.C)};
q.Avb=function(){dbc(this,"")};q.$Vb=function(){var a=T(this,"waffle-assistant-answers-input-box");dbc(this,a.value);a.value=""};q.uzb=function(a){dbc(this,a.C);bl(function(){kac(this.C,1)},150,this);this.O.Pb(2652,this.Tc)};function dbc(a,b){a.setActive(!0);a.dispatchEvent("assistant-sidepane-set-active-panel");bl(function(){var a=this.C;j9b(a.C,b);a.C.focus()},150,a)}
function bbc(a,b,c,d){c=c||new dW;a.Da=b;var e=a.L;e.reset();var g=[],h=new Gac(c);if(ooa){for(var k=new rg,l=new rg,m=0;m<d.length;m++){var p,r=d[m];p=Dac(r);Ac(r,6)&&(r=D(r,6))&&p.push(Eac(r,0));for(r=0;r<p.length;r++){var t=h.O.get(p[r].name.toLowerCase(),-1);-1!=t&&k.add(t);t=h.$.get(p[r].name.toLowerCase(),-1);-1!=t&&l.add(t)}}k=k.Fd();l=l.Fd();Ub(k);Ub(l);h.F=k;h.L=l;for(l=0;l<d.length;l++)switch(m=d[l],m.getChartType()){case "BarChart":k=e;r=h;t=m;m=g;if((FW(k,12)||FW(k,1))&&(p=D(t,6))&&-1!=
r.O.get(p.toLowerCase(),-1)){r=Uac(r,t);if(0<r.length){var t=GW(r),w=Vac(t.Hza);w&&FW(k,12)&&EW(k,m,w+" of "+t.name+" by "+p,12)}1<r.length&&FW(k,1)&&EW(k,m,"Correlation between "+r[0].name+" and "+r[1].name,1)}break;case "ScatterChart":k=e;p=h;r=m;m=g;FW(k,1)&&(p=Uac(p,r),1<p.length&&EW(k,m,"Correlation between "+p[0].name+" and "+p[1].name,1));break;case "PieChart":if(k=e,p=h,t=m,m=g,FW(k,13)){r=[];t=Dac(t);for(w=0;w<t.length&&-1!=p.O.get(t[w].name.toLowerCase(),-1);w++)r.push(t[w]);p=r;1==p.length&&
4==p[0].Hza&&EW(k,m,"Distribution of "+p[0].name,13)}}}FW(e,0)&&(l=h.C,d=Nac(h,!0,!0),0<Bc(l,1)&&-1!=d&&(l=BW(h),d=CW(h,d),l=DW(h,l),d!=l&&EW(e,g,"Top "+d+" by "+l,0)));FW(e,1)&&1<Bc(h.C,1)&&(2<=h.J.length?(d=Mac(h.J,h.L),l=Rac(2<=d.length?d:h.J)):l=xW(Bc(h.C,1),2),d=DW(h,l[0]),l=DW(h,l[1]),d!=l&&EW(e,g,"Correlation between "+d+" and "+l,1));FW(e,2)&&(d=BW(h,!0),-1!=d&&EW(e,g,GW(Yac)+" of "+DW(h,d),2));if(FW(e,4)&&(k=h.C,d=BW(h,!0),0<Bc(k,3)&&-1!=d&&(d=DW(h,d),l=Oac(h),-1!=l&&(k=k.$d(l),m=CW(h,l),
0<Bc(k,3)&&m!=d)))){a:for(p=5;;)if(r=h.C.$d(l),t=xW(Bc(r,3),1)[0],w=D(r,3,t),p--,AW(D(r,2,t))||0==p){l=w;break a}EW(e,g,GW(Yac)+" of "+d+" when "+m+" is "+D(k,2,l),4)}FW(e,8)&&(l=h.C,d=Nac(h,!0,!0),0<Bc(l,1)&&-1!=d&&(l=DW(h,BW(h)),d=CW(h,d),d!=l&&EW(e,g,d+" with "+GW(Xac)+" "+l,8)));FW(e,9)&&0<Bc(h.C,1)&&(d=DW(h,BW(h)),EW(e,g,GW(Xac)+" "+d,9));FW(e,10)&&(d=h.C,0<Bc(d,3)&&(l=Oac(h),-1!=l&&(k=CW(h,l),0<Bc(d.$d(l),3)&&EW(e,g,"Most frequent "+k,10))));if(FW(e,11)){d=h.C;k=BW(h,!0);a:{if(1==h.R.length&&
(l=h.R[0],!D(h.C.$d(l),5)))break a;l=-1}-1!=l&&-1!=k&&(k=DW(h,k),d=d.$d(l),0<Bc(d,2)&&(l=Pac(h,l),EW(e,g,GW(Yac)+" of "+k+" "+GW(Zac)+" "+D(d,2,l),11)))}((d=3>g.length)||0==xW(5,1)[0])&&FW(e,6)&&(k=h.C,0<Bc(k,1)&&0<Bc(k,2)&&(p=BW(h),l=Nac(h),k=k.$d(l),m=CW(h,l),p=DW(h,p),0<Bc(k,2)&&m!=p&&(l=Pac(h,l),EW(e,g,"Show "+p+" for "+m+" "+D(k,2,l),6))));(d||0==xW(5,1)[0])&&FW(e,7)&&(k=h.C,d=Nac(h,!0,!0),1<Bc(k,2)&&-1!=d&&(2<=h.D.length?(l=Mac(h.D,h.F),l=Rac(2<=l.length?l:h.D)):l=xW(Bc(h.C,2),2),l=l[0]==d?
l[1]:l[0],k=k.$d(l),m=CW(h,l),d=CW(h,d),0<Bc(k,2)&&m!=d&&(h=Pac(h,l),EW(e,g,"What is "+d+" where "+m+" is "+D(k,2,h),7))));e.C=g;e.L=b;noa&&Wac(e);a.setVisible(null!=b);gac(a.C,b,c);a.Ob()&&iac(a.C)}q.Ztb=function(a){a.stopPropagation();a.preventDefault();this.ea&&(Yk(tj(uj(this.ea.Cf("/answers/logoptout"),y(this.Brb,this)),y(this.Arb,this)),"POST").Te(),this.O.Pb(2663,this.Tc))};
q.Rqb=function(a){a.stopPropagation();a.preventDefault();Yo("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};q.Brb=function(a){a.$k()&&abc(this)};q.Arb=da();function ebc(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+fbc()+"</div>");return V(a)}
function gbc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+fbc()+"</div>")}function fbc(){var a;a=""+U(rt({Oe:"waffle-assistant-formatting-edit-button",content:js("Edit"),style:4}));return V(a)};function IW(a,b,c){lW.call(this,a,c);a=vb(this.D.Efa(),G5b);this.C=new AU(!1,a,7);this.Ma(this.C);this.O=new st("",this.oa);this.Ma(this.O);this.R=b;this.L=!1;this.J=-1}z(IW,lW);var hbc={fda:"waffle-assistant-banding-color-picker-container",pda:"waffle-assistant-formatting-edit-button",pH:"waffle-assistant-banding-range"};q=IW.prototype;q.Sa=function(){IW.Z.Sa.call(this);mW(this).appendChild(Or(ebc))};
q.Ha=function(){IW.Z.Ha.call(this);this.getHandler().V(this.O,"action",this.Zmb).V(this.C,"banding-scheme-changed",this.nib);this.R.Pb(2768,void 0)};q.cz=function(a){var b=T(this,hbc.fda);this.C.render(b);M5b(this.C);var b=T(this,hbc.pH),c=this.D.mJ(),d=Rh(c);nn(b,Ow(d));ibc(this,c);b=T(this,hbc.pda);this.O.Va(b);a()};q.Vy=function(){Ap(this.Ba,"Suggested alternating background colors");nr(this.C,"Choose a color scheme")};q.Px=n("assistantBandingFeedback");q.iE=n(2672);q.hE=n(2671);
q.Zmb=function(a){Tn.dispatchEvent({type:"show-banding-pane-recommendation",PQa:this.D,l4a:N5b(this.C)});a.stopPropagation()};q.nib=function(a){if(!this.L&&BU(this.C)){var b=this.J;this.J=this.C.Wh();this.J==b?this.dispatchEvent(new SV("assistant-sidepane-remove-banding",this,2797)):this.dispatchEvent(new SV("assistant-sidepane-apply-banding",this,2673));a.stopPropagation()}};
function ibc(a,b){a.L=!0;var c;c=b.fb();b=Rh(b);c=ritz.getWorkbookRangeIntersectingIds(c,b.jc(),b.bc(),b.Uc(),b.bd(),7,!1);c.length?(c=ritz.getBandedRangeByWorkbookRangeId(c[0]),c=(new Li).od(Fd.Ca(),c),c=G5b(c)):c=null;c?(c=O5b(a.C,c),jL(a.C,c?c.getElement():null)):jL(a.C,null);a.J=a.C.Wh();a.L=!1};function JW(a,b){lW.call(this,a,b);this.C=new st("",this.oa);this.Ma(this.C);this.mb=Fc(a,6)}z(JW,lW);var KW={pda:"waffle-assistant-formatting-edit-button",wYa:"waffle-assistant-conditionalformat-format-preview",B_a:"waffle-assistant-conditionalformat-rule-holder",S1:"waffle-assistant-conditionalformat-description",GZa:"one-rule",y0a:"two-rules",n0a:"three-rules",ZZa:"waffle-assistant-conditionalformat-format-preview-label"};q=JW.prototype;q.Sa=function(){JW.Z.Sa.call(this);mW(this).appendChild(Or(gbc))};
q.Ha=function(){JW.Z.Ha.call(this);var a=T(this,KW.pda);this.C.Va(a);TV(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.Mhb)};q.cz=function(a){nn(T(this,KW.S1),Gc(this.D,3));var b=T(this,KW.B_a),c=new jbc(this,this.oa);this.Ma(c);c.Va(b);TV(b,"Apply conditional format rules");a()};q.Vy=oa;q.Px=n("assistantConditionalFormatFeedback");q.iE=n(2630);q.hE=n(2629);
q.Mhb=function(){kbc(this);this.dispatchEvent(new SV("assistant-sidepane-change-selection",this,2670,void 0,void 0,Rh(D(this.mb[0],1,0))));Xn()};function kbc(a){a.dispatchEvent(new SV("assistant-sidepane-apply-conditional-format-rules",a,2563))}function jbc(a,b){kr.call(this,void 0,void 0,b);this.C=a}z(jbc,kr);
jbc.prototype.Ge=function(a){jbc.Z.Ge.call(this,a);var b=this.C.mb,c;switch(b.length){case 0:break;case 1:c=KW.GZa;break;case 2:case 4:c=KW.y0a;break;default:c=KW.n0a}for(var d=0;d<b.length;d++){var e=b[d],g=Um("DIV");Ep(g,[KW.wYa,c]);var h=Um("DIV");Dp(h,KW.ZZa);g.appendChild(h);nn(h,"123");if(Ac(e,2)){var k=D(D(e,2),1);switch(D(D(k,1),1)){case 9:case 13:var k=Fc(D(k,1),2)[0],l=Fc(e,1)[0];nn(h,hF(k,Gc(l,1),Gc(l,2),Gc(l,4)))}}Z4b(e,g);a.appendChild(g)}};jbc.prototype.gj=function(){kbc(this.C);return!0};function lbc(a,b,c){WV.call(this,2,b,a,c)}z(lbc,WV);q=lbc.prototype;q.yT=n("Formatting");q.a4=function(a){return 2==a||4==a};q.uW=function(a){var b=D(a,1);switch(b){case 2:return new JW(a,this.oa);case 4:return a=new IW(a,this.O,this.oa),this.getHandler().V(a,"assistant-sidepane-apply-banding",this.fOb).V(a,"assistant-sidepane-remove-banding",this.iCb),a;default:throw Error("Unsupported recommendation type: "+b);}};
q.fOb=function(a){P$b(this.Xa,"Alternating colors applied",this.oa,y(this.oib,this,a.C))};q.iCb=function(){this.Xa.clear()};q.oib=function(a){this.dispatchEvent(new SV("assistant-undo-pressed",a,2796))};q.t1=function(a){lbc.Z.t1.call(this,a);this.setVisible(!a)};q.Ota=function(a){return this.Id()?(this.setVisible(!1),a):lbc.Z.Ota.call(this,a)};q.Mca=n(3);function LW(a,b,c,d){Vu.call(this,a,b,c,d,void 0,void 0,!0)}z(LW,Vu);LW.prototype.Sa=function(){LW.Z.Sa.call(this);Dp(this.Ba,"waffle-assistant-toast");Dp(T(this,"docs-ui-toast-content"),"waffle-assistant-toast-content")};LW.prototype.QH=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Bq(this,b);LW.Z.QH.call(this,a,b,c)};LW.prototype.Hl=function(a,b,c,d){this.QH(a,b,d);a=Dq(this,b);If(this.getHandler(),a,nd,y(function(){this.setVisible(!1);c()},this))};function mbc(){this.C=null}z(mbc,G);mbc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function P$b(a,b,c,d){a.clear();a.C=new LW(b,c,!1,5E3);a.C.render();d&&a.C.Hl("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}mbc.prototype.ma=function(){mbc.Z.ma.call(this);this.clear()};function nbc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+ns("Press enter to insert formula")+'"></span></div>');return V(a)};function MW(a,b){wq.call(this);this.C=a;this.D=b}z(MW,wq);q=MW.prototype;q.Sa=function(){this.Ba=Or(nbc,{name:this.C,title:this.D})};q.Ha=function(){MW.Z.Ha.call(this);var a=T(this,"waffle-assistant-quicksum-entry-name");TV(a);this.getHandler().V(this.Ba,"keypress",this.HVb);R(this.Ba,!1)};q.getFunctionName=f("C");q.Wa=function(a){nn(T(this,"waffle-assistant-quicksum-entry-value"),a||"");R(this.Ba,!!a)};q.Ta=function(){return fq(this.Ba)};
q.HVb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new K("insert",this)))};function NW(a,b,c,d,e){wq.call(this,e);this.Ka=a;this.ea=b;this.R=c;this.L=d;this.D=a.C;this.Da=new Li;this.Y=Wo(new Vo,17).Fa();this.X=Wo(new Vo,2).Fa();this.O=!1;this.F=[];this.C=null;this.J=[]}z(NW,wq);
NW.prototype.Ha=function(){NW.Z.Ha.call(this);this.wi(new MW(ritz.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.wi(new MW(ritz.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.wi(new MW(ritz.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.wi(new MW(ritz.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.wi(new MW(ritz.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new tW(this.Ba,this.ea,this.D,this.R);this.C.J=this.O;H(this,this.C);this.getHandler().V(this,"insert",
this.$).V(this.C,"formula_inserted",this.Na)};
function obc(a){function b(a){return l?ritz.renderNumberAsFormattedString(a,m):null}if(ww(a.D)){var c=xw(a.D),d=tC(c),e=UI(a.D);if(yb(d,c.Nt,c)){var g=[];a.F=[];for(c=0;c<d.length;c++){var h=d[c],k=fha(e+"",h.jc(),h.bc(),h.Uc(),h.bd());g.push(a.Da.serialize(k));a.F.push(h)}if(d=ritz.quickSum(g)){R(a.Ba,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.Ad(0).Wa(b(d.sum));a.Ad(1).Wa(b(d.average));a.Ad(2).Wa(b(d.min));a.Ad(3).Wa(b(d.max));1<e?a.Ad(4).Wa(ritz.renderNumberAsFormattedString(e,
c)):R(a.Ba,!1);if(a.C){a.C.O=[];a.J=[];for(c=0;c<a.qd();++c)d=a.Ad(c),a.J.push(pbc(a,d.getFunctionName()));a.C.O=a.J}}else R(a.Ba,!1)}else R(a.Ba,!1)}else R(a.Ba,!1)}NW.prototype.$=function(a){var b=a.target;a=this.F[0];a=new N(a.left,a.Uc());b=b.getFunctionName();b=pbc(this,b);a=new LE(xw(this.D),a,b);this.R.C(a);this.L.Pb(2624,this.X)};NW.prototype.Na=function(){this.L.Pb(2624,this.Y)};function pbc(a,b){var c=Vw(a.Ka.O);a=vb(a.F,function(a){return Ow(a)});return"="+b+"("+a.join(c)+")"};function qbc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(rt({content:js("INSERT CHART"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(rt({Oe:"waffle-autovis-lightbox-close",content:ks(""+U(Pu({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:js("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">\x3c!-- TODO(cuiffo): Replace with real icons --\x3e'+
U(rt({content:ks("&#10094;"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:ls('aria-label="'+ns("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(rt({content:ks("&#10095;"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:ls('aria-label="'+ns("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.VFb)+"</div></div></div>");return V(a)}function rbc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function OW(a,b,c){wq.call(this,c);this.F=a;this.D=b;this.J=[];this.C=new st("",this.oa);this.Ma(this.C);this.R=new st("",this.oa);this.Ma(this.R);this.O=new st("",this.oa);this.Ma(this.O);this.L=new st("",this.oa);this.Ma(this.L)}z(OW,wq);q=OW.prototype;q.Sa=function(){OW.Z.Sa.call(this);this.Ba=Or(qbc,{VFb:this.F.length})};
q.Ha=function(){OW.Z.Ha.call(this);var a=X.RG.isEnabled();sbc(this,!a);a=T(this,"waffle-autovis-lightbox-close");this.C.Va(a);a=T(this,"waffle-autovis-lightbox-insert");this.R.Va(a);var b=T(this,"waffle-autovis-lightbox-previous");this.O.Va(b);b=T(this,"waffle-autovis-lightbox-next");this.L.Va(b);tbc(this);ubc(this,this.D,!1);this.getHandler().V(document.body,dd,this.YQb).V(this.Ba,"keydown",this.ZQb).V(Tm(),"resize",this.bRb).V(this.C,"action",this.close).V(this.R,"action",this.eqb).V(this.O,"action",
this.aRb).V(this.L,"action",this.$Qb);b=new Cv(this.Ba,this.oa);Dv(b);H(this,b);a.focus()};function tbc(a){var b=T(a,"waffle-autovis-lightbox-content"),c=T(a,"waffle-autovis-lightbox-content-inner");a=T(a,"waffle-autovis-lightbox-page-count");var d=Rm();a=cq(a);var e=d.height-a.height-195,g=d.width-200;.75<e/g?(d=g,e=.75*g):d=e/.75;Zp(c,d,e);Zp(b,d,e+a.height+35)}function sbc(a,b){Hp(a.Ba,"waffle-autovis-lightbox-readonly",b)}
function ubc(a,b,c){c&&Wn("Page "+(b+1+(" of "+(a.F.length+"."))));a.J[b]?vbc(a,b):a.F[b]&&r$b(a.F[b],y(a.Cjb,a,b),!0)}q.Cjb=function(a,b){if(!this.isDisposed()&&b){var c=T(this,"waffle-autovis-lightbox-container"),d=Or(rbc);c.appendChild(d);this.J[a]=d;HV(b,d,pm);vbc(this,a)}};function vbc(a,b){R(a.J[a.D],!1);R(a.J[b],!0);a.O.Qa(0!=b);a.L.Qa(b!=a.F.length-1);var c=T(a,"waffle-autovis-lightbox-page-number");nn(c,b+1);a.D=b}q.YQb=function(a){!kn(this.Ba,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.ZQb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&ubc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||wbc(this);a.stopPropagation()};q.bRb=function(){var a=T(this,"waffle-autovis-lightbox-container");$m(a);this.J=[];tbc(this);ubc(this,this.D,!0)};q.eqb=function(){this.close();u$b(this.F[this.D],2256)};q.aRb=function(){0!=this.D&&ubc(this,this.D-1,!0);0==this.D&&this.L.Ba.focus()};q.$Qb=function(){wbc(this);this.D==this.F.length-1&&this.O.Ba.focus()};
function wbc(a){a.D!=a.F.length-1&&ubc(a,a.D+1,!0)}q.close=function(){this.dispose()};q.xd=function(){OW.Z.xd.call(this);var a=this.F[this.D];a&&a.Ba&&a.Ba.focus()};function xbc(a,b){L.call(this);this.Za=a;this.wb=b;this.F=a.C;this.Da=new Li;this.La=Sj();this.J=Sj();this.gc=this.C=this.D=this.L=this.O=this.va=this.Y=null;this.$a=!1;this.$=null;this.Xa=!0;this.Pa=this.Ka=!1;this.Na=this.Ua=null;this.R=wJ.getInstance();this.Ga=this.ea="";b=this.Za.O.Fr();this.X=new hW;F(this.X,2,Tna);a=xoa&&!a.Id();F(this.X,3,a);F(this.X,4,poa);a=om&&"en"==cD(b);F(this.X,5,a);F(this.X,6,soa);F(this.X,7,yoa);F(this.X,10,!1);a=new M(this);H(this,a);a.V(this.wb,"Ca",this.iWb)}
z(xbc,L);var ybc={n0b:"cu",HWa:"cs",GWa:"ce",jZa:"ls",iZa:"le"};q=xbc.prototype;q.update=function(a,b,c){c&&this.C&&!zb(c,function(a){return $ga(a,this.C.rect)},this)||(this.La.cancel(!0),this.Y&&this.Y.cancel(!0),a&&(this.Pa=!0,this.J.cancel(!0),this.D=this.L=this.O=this.va=null),this.La=zbc(),this.La.addCallback(this.z2a,this),this.La.addCallback(Fa(this.A2a,b),this))};q.lh=ea("Ua");q.iWb=function(){this.Y&&3==this.wb.getState()&&(this.Y.Hb(),this.Y=null)};
function zbc(){var a=null,b=new Lj(function(){null===a||cl(a)}),a=bl(function(){b.Hb()});return b}q.Nib=function(){this.Ka=!0};q.z2a=function(){var a=this.F.getActiveGrid();if(a){var b=xw(this.F),c=tC(b),d=Abc(this,c||[]),e=Abc(this,this.gc||[]);d&&!e||!d&&!Bbc(c,this.gc)?(this.D=null,this.$a=!0):this.$a=!1;this.gc=c;var g=wC(b).clone();A(tC(b),function(a){yh(g,a)});this.$=new Mh(a.fb(),"",g)}else this.$=null};
q.A2a=function(a){this.ea=xJ(this.R,lj.Dva);var b=this.F.getActiveGrid(),c=this.$&&this.$.vd;if(!b||b.fb()!=c||null===c)return this.$=null;var d=this.F.getActiveGrid().D,b=wA(d,this.$.rect);b.addCallback(function(){if(!this.F.getActiveGrid()||rw(this.F)!=c)return null;var b=xw(this.F),g=zA(b,this.$.rect,hc(Xg),a?void 0:500),h=sA(b.F,"r"),k=b.Om("r");return!b.Nt(g)||h>=g.jc()&&RIa(b)||k<=g.Uc()&&QIa(b)?(this.dispatchEvent(new K("ls")),yA(d,g,hc(Xg),a?void 0:500).addCallback(this.V4a,this)):g},this);
b.addCallback(function(a){var b=this.F.getActiveGrid();return a&&b&&b.fb()==c&&null!==c?Cbc(this,a,xw(this.F)):null},this);b.addCallback(function(b){b=b&&new Mh(c,"",b);if(null===b&&null!==this.C||null!==b&&!b.equals(this.C))this.D=this.L=this.O=this.va=null;var d=null!==b&&b.equals(this.C);if(d=this.Pa||this.$a||!d&&(null===this.O||null!==this.L&&null===this.D))this.Xa=this.Ka&&this.Xa||!this.C||!b||!b.rect.intersects(this.C.rect);var e=null!==b&&b.contains(this.C);this.C=b;""!=this.ea&&(yJ(this.R,
this.ea),this.ea="");d&&(a&&(this.Ga=xJ(this.R,lj.Eva)),this.J.cancel(!0),this.J=Sj(),this.J.addCallback(this.H2a,this),this.J.addCallback(this.S4a,this),a&&(this.J.addCallback(Fa(this.O4a,e),this),this.Ua&&!pw(this.Za.F)&&toa?this.J.addCallback(this.beb,this):(this.J.addCallback(this.E2a,this),this.J.addCallback(this.F2a,this)),this.J.addCallback(this.N4a,this)),Oj(this.J,this.Nib,this))},this);return b};
q.H2a=function(){if(null!==this.C&&null!==this.C.rect&&null===this.va){var a=xJ(this.R,lj.rua);this.va=ritz.getAssistantConfidence(""+this.C.vd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,this.Da.serialize(this.X));yJ(this.R,a)}};q.V4a=function(){this.dispatchEvent(new K("le"))};q.S4a=function(){this.dispatchEvent(new Dbc(this.C,this.va))};q.O4a=function(a){a=new Ebc(a,this.Pa);this.Pa=!1;this.dispatchEvent(a)};
q.beb=function(){if(null===this.C||null===this.C.rect||null!==this.L&&null!==this.D)return null;J(this.Na);return 3!=this.wb.getState()?(this.Y=new Lj,this.Y.addCallback(this.QRa,this),this.Y):this.QRa()};
q.QRa=function(){var a=xJ(this.R,lj.Gva),b=Fbc(this),c=b&&!b.hNa,b=ritz.getAssistantRequestProto(this.C.vd.toString(),this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,c?b.rows:[],c?b.Be:[]),b=this.Da.od(fW.Ca(),b),c=new Li;c.wv=!0;var b=Xi(c.serialize(b)),d=new Lj;this.Na=tj(uj(rj(Xk(Yk(this.Ua.Cf("/explore/getrecommendations").Ff("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=xJ(this.R,lj.Fva);b=Gbc(this,b.Mf());yJ(this.R,c);this.L=Fc(b,
1);this.D=Fc(b,2);this.Na=null;yJ(this.R,a);d.Hb()},this),function(){this.L=[];this.D=[];d.Hb()},this).Te();return d};
q.E2a=function(){function a(){b=null;ritz.continueAssistantRecommendation(this.O)?(this.L=Fc(Gbc(this,ritz.getAssistantRecommendations(this.O)),1),d.Hb()):b=bl(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.L)return null;this.O=ritz.newAssistantRecommender(this.Da.serialize(this.X));this.D=this.L=null;ritz.startAssistantRecommendation(this.O,""+this.C.vd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var b=null,c=
y(function(){null!==b&&(cl(b),this.D=this.L=this.O=b=null)},this),d=new Lj(c),b=bl(a,5,this);return d};q.F2a=function(){var a=Fbc(this);a&&this.O&&null===this.D&&(this.D=a.hNa?[]:Fc(Gbc(this,ritz.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.Be)),2))};q.N4a=function(){this.Ka=!1;var a=this.D&&0<this.D.length?this.D:this.L;""!=this.Ga&&(yJ(this.R,this.Ga),this.Ga="");this.dispatchEvent(new Hbc(this.C,a||[],this.Xa))};function Gbc(a,b){return a.Da.od(eW.Ca(),b)}
function Cbc(a,b,c){b=b.clone();fc(Xg,function(a){for(var d=!0;d&&b;){for(var g=bh(a),h=0;h<(g?b.width:b.height);h++){var k=Gh(b,a),l=g?b.bc():b.jc();if(g&&!dJb(c.sf(k,l+h))||!g&&!dJb(c.sf(l+h,k))){d=!1;break}}d&&(dha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function Bbc(a,b){return Wb(a,b,function(a,b){return zh(a,b)})}
function Fbc(a){var b=a.F.getActiveGrid();if(!b||!a.C||b.fb()!=a.C.vd)return null;for(var c=tC(xw(a.F)),c=vb(c,Fa(xh,a.C.rect)),c=ub(c,sa),d=vb(c,function(a){return new nh(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new rg,e=new rg,g=0;g<d.length;g++){for(var h=0;h<d[g].width;h++)e.add(d[g].left+h);for(h=0;h<d[g].height;h++)b.add(d[g].top+h)}a=Abc(a,c);return{rows:b.Fd(),Be:e.Fd(),hNa:a}}
function Abc(a,b){a.F.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(Ah(b)||0==Kh(b))return!0;a=zMa(xw(a.F).Y,b.top,b.left);return b.equals(a)}function Dbc(a,b){K.call(this,"cu");this.C=a;this.F=b}z(Dbc,K);function Hbc(a,b,c){K.call(this,"ce");this.C=a;this.F=b;this.Y=c}z(Hbc,K);function Ebc(a,b){K.call(this,"cs");this.C=a;this.F=b}z(Ebc,K);function PW(a,b,c,d,e,g){sU.call(this,g);this.Na=a;this.Gb=b.C;this.Ka=c;this.Wc=d;this.L=e;this.Y=new NW(b,c,d,e,this.oa);this.Ma(this.Y);this.R=new KV(!1,"#4285f4");this.Ma(this.R);this.O=null;this.mb=this.bb=!1;this.Xa=!0;this.Ua=wJ.getInstance();this.ea=this.$="";this.Tc=Wo(new Vo,10).Fa()}z(PW,sU);q=PW.prototype;q.Sa=function(){PW.Z.Sa.call(this);this.Ba=Or(this.Qta(),{cOb:om});Dp(this.Ba,"waffle-assistant-sidepanel")};q.Qta=v;
q.Ha=function(){PW.Z.Ha.call(this);var a=T(this,"waffle-assistant-quicksum-panel");this.Y.Va(a);a=T(this,"waffle-assistant-spinner-container");this.R.render(a);this.getHandler().V(this,"close-sidebar",this.Dma).V(this.Na,ybc.jZa,this.qma).V(this.Na,ybc.iZa,this.pma).V(this.Na,ybc.HWa,this.Qla).V(this.Na,ybc.GWa,this.Pla).V(T(this,"waffle-assistant-scroll-pane"),"scroll",o9b(this.u1,10,this));a=X.RG.isEnabled();this.Nca(!a)};
q.resize=function(){var a=T(this,"waffle-assistant-sidepane-content"),a=cq(a).height,b=T(this,"waffle-assistant-spinner-container");Kp(b,"margin-top",a/2-16+"px")};q.lh=oa;function Ibc(a,b){var c=a.FG();0!=c.length&&(J(a.O),c=c.filter(function(a){return a instanceof nW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new OW(c,b,a.oa),a.O.render(),H(a,a.O),sbc(a.O,a.mb)))}
q.Nca=function(a){this.mb=a;Hp(this.Ba,"waffle-assistant-readonly",a);var b=this.Y;b.O=a;b.C&&(b.C.J=a);Hp(b.Ba,"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&sbc(this.O,a)};q.setVisible=function(a){var b=this.Ta();PW.Z.setVisible.call(this,a);a&&!b&&(this.ea=xJ(this.Ua,lj.Kva),this.R.setActive(!0),QW(this));a||this.zT(!0)};q.qma=function(){this.Ta()&&(this.zT(!0),this.R.setActive(!0),QW(this))};q.pma=function(){this.Ta()&&(this.R.setActive(!1),QW(this))};
q.Qla=function(a){this.Ta()&&(this.L.Pb(2775,this.Tc),this.zT(void 0,a.C,a.F),this.M9()||this.R.setActive(!0),QW(this),this.Xa=!1)};q.Pla=function(a){if(this.Ta()){this.L.Pb(2776,this.Tc);var b=a.F;0<b.length&&(this.$=xJ(this.Ua,lj.Jva));this.zT(!1);this.R.setActive(!1);this.Pta(b,a.C);a=a.Y;b=this.FG();0<b.length&&this.bb&&(b[b.length-1].Qb=!0);this.bb=!1;QW(this);this.Rta(a);this.u1()}};q.Pta=v;q.Rta=v;q.zT=v;q.Fja=v;
function QW(a){var b=a.M9(),c=fq(T(a,"waffle-assistant-quicksum-panel")),d=a.R.Ob(),b=b||c||d,c=a.Fja();a=T(a,c);R(a,!b)}q.M9=v;q.u1=v;q.FG=v;q.KGa=Mf;function Jbc(a){return T(a,"waffle-assistant-scroll-pane").scrollTop+cq(T(a,"waffle-assistant-sidepane-content")).height}q.Fc=oa;q.Id=f("mb");q.Dma=function(){this.L.Pb(2226,this.Tc)};q.XEb=function(){""!=this.$&&(yJ(this.Ua,this.$),this.$="");""!=this.ea&&(yJ(this.Ua,this.ea),this.ea="");this.Xa||(this.L.Pb(2777,this.Tc),this.Xa=!0)};function Kbc(a,b,c){a=a||{};c=c||{};b=V;var d=ks(""+Lbc()),e;e=c||{};e=V(""+('<div class="waffle-assistant-empty-list-old" style="'+(e.cb?"/*"+e.cb+"*/":"")+'display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title-old">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body-old">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>'));
return b(U(CU(hs({title:d,Lj:ks('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:js("autovis"),S0:js("waffle-assistant-title"),jO:js("waffle-assistant-sidepane-content")},a))))}
function Mbc(a,b,c){a=a||{};b=V;var d=ks('<div class="waffle-assistant-replaceable-title">'+Lbc()+"</div>"),e;e=a||{};c=c||{};var g=V,h=c;e=e||{};h=h||{};h=""+('<div class="waffle-assistant-empty-list" style="'+(h.cb?"/*"+h.cb+"*/":"")+'display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(s9b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');h=e.cOb?
h+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":h+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=V(h+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');
c=g('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none"></div></div></div>');return b(U(CU(hs({title:d,
Lj:ks(""+c),id:js("autovis"),S0:js("waffle-assistant-title"),jO:js("waffle-assistant-sidepane-content")},a))))}function Lbc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(s9b({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function RW(a,b,c,d,e,g,h){PW.call(this,a,b,c,d,e,h);this.Za=g;this.Qb=b;this.X=new wq(this.oa);this.Ma(this.X);this.J=new mbc;H(this,this.J);this.D=[];this.F=null;this.Da=new st("",h,4);rr(this.Da,2);this.Ma(this.Da)}z(RW,PW);
var SW={kz:"waffle-assistant-scroll-pane-feature-content",SXa:"waffle-assistant-empty-list",jYa:"waffle-assistant-features",bZa:"waffle-assistant-empty-list-learn-more",bea:"waffle-assistant-expanded-panel",t_a:"waffle-assistant-replaceable-title",Pkc:"waffle-assistant-scroll-pane",pN:"waffle-assistant-title"},Nbc={defaultHelpArticleId:"6280499"};q=RW.prototype;q.Qta=function(){return Mbc};q.Fja=n("waffle-assistant-empty-list");
q.Ha=function(){RW.Z.Ha.call(this);this.X.Va(T(this,SW.bea));TV(this.C.Ba,"Close");var a=this.Qb.O.Fr();om&&"en"==cD(a)&&(a=new HW(this.Za,this.Ka,this.Gb,this.Wc,this.L,this.J,this.oa),this.Ma(a),this.D.push(a));if(xoa||yoa)a=new lbc(this.L,this.J,this.oa),this.Ma(a),this.D.push(a);a=new rW(this.Gb,this.Ka,this.L,this.J,this.oa);this.Ma(a);this.D.push(a);var b=T(this,SW.jYa);A(this.D,function(a){a.render(b);this.X.Ma(a.D,!0)},this);this.Da.Va(T(this,SW.bZa));this.getHandler().V(this.Da,"action",
this.hWb);Obc(this)};q.hWb=function(){Q.Hm.Wb(Nbc)};q.Pta=function(a,b){for(var c=0;c<this.D.length;c++){for(var d=[],e=0;e<a.length;e++){var g=Gc(a[e],1);this.D[c].a4(g)&&d.push(a[e])}0<d.length&&this.D[c].Nta(d,b)}};q.Rta=function(){A(this.D,function(a){B9b(a)})};q.zT=function(a,b,c){A(this.D,function(d){d.s1(a,b,c)})};q.M9=function(){return!!zb(this.D,function(a){return a.Pma()})};
q.u1=function(){var a=Jbc(this);A(this.D,function(b){this.F&&this.F!=b||(b instanceof rW&&Gf(this.getHandler(),b,"assistant-done-rendering",this.XEb),a=b.Ota(a))},this)};q.FG=function(){if(this.F)return this.F.D.D;var a=[];A(this.D,function(b){Ob(a,A9b(b))});return a};q.Nca=function(a){RW.Z.Nca.call(this,a);Obc(this)};q.lh=function(a){A(this.D,function(b){b.lh(a)})};
q.Fc=function(){var a=T(this,SW.kz),b=T(this,SW.t_a),c=T(this,SW.pN),d=this.X.Ba;if(this.F)this.F.D.setVisible(!1),this.F.setActive(!1),this.F=null,R(a,!0),R(d,!1),Mr(b,Lbc),wp(b,"label"),this.resize();else if(this.F=zb(this.D,function(a){return a.Ob()}))R(a,!1),R(d,!0),this.F.D.setVisible(!0),C9b(this.F,b),Ap(b,this.F.yT());bq(c,cq(b).height);bl(function(){var a=$v;a&&a.dispatchEvent("resize");this.u1()},150,this)};
q.setVisible=function(a){var b=this.Ta();RW.Z.setVisible.call(this,a);a&&!b&&Pbc(this,!0);a||this.J.clear()};q.Dma=function(){RW.Z.Dma.call(this);this.F&&this.Fc()};q.qma=function(){RW.Z.qma.call(this);Pbc(this,!0)};q.pma=function(){RW.Z.pma.call(this);Pbc(this,!1)};q.Qla=function(a){RW.Z.Qla.call(this,a);Pbc(this,!0,a.C)};q.Pla=function(a){RW.Z.Pla.call(this,a);Pbc(this,!1)};function Obc(a){A(a.D,function(a){a.t1(this.Id())},a)}q.KGa=f("D");function Pbc(a,b,c){A(a.D,function(a){c||w9b(a.D,b)})};function Qbc(a){var b;a=a||{};return V('<div class="docs-explore-promo-base '+W(a.Wf)+'"><div class="docs-explore-promo-content">'+(a.WE?'<div class="docs-explore-promo-header">'+U(null==(b=a.WE)?"":b)+"</div>":"")+'<div class="docs-explore-promo-description">'+U(null==(b=a.FW)?"":b)+'<div class="docs-explore-promo-buttons">'+(a.oI?U(rt({Oe:"docs-explore-promo-button docs-explore-promo-continue-button",content:ks(""+U(a.oI)),style:4})):"")+(a.wI?U(rt({Oe:"docs-explore-promo-button docs-explore-promo-close-button",
content:ks(""+U(a.wI)),style:4})):"")+"</div></div></div>"+(a.oMa?V('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+U(s9b({color:a.oMa,iconSize:"32"}))+"</div></div>"):"")+"</div>")};function Rbc(a,b){wq.call(this,b);this.F=new st("",b);this.Ma(this.F);this.C=new st("",b);this.Ma(this.C);this.D=new st("",b);rr(this.D,2);this.Ma(this.D);this.J=a;Kqa([Q.qda,Q.rda,Q.Iva],!0)}z(Rbc,wq);q=Rbc.prototype;q.Sa=function(){this.Ba=Or(Qbc,this.J)};
q.Ha=function(){Rbc.Z.Ha.call(this);var a=T(this,"docs-explore-promo-continue-button");a&&this.F.Va(a);(a=T(this,"docs-explore-promo-close-button"))&&this.C.Va(a);(a=T(this,"docs-explore-promo-icon"))&&this.D.Va(a);this.getHandler().V(this.F,"action",this.$Ia).V(this.C,"action",this.b6a).V(this.D,"action",this.wpb)};q.show=function(a){Q.Iva.Wb();this.render(a)};q.$Ia=function(a){Q.qda.Wb();a.stopPropagation()};q.b6a=function(a){Q.rda.Wb();a.stopPropagation()};q.wpb=function(a){this.$Ia(a)};function Sbc(a){return V('<div class="waffle-assistant-walkthrough-promo-content"><h1 class="waffle-assistant-walkthrough-promo-header">'+U(a.WE)+'</h1><p class="waffle-assistant-walkthrough-promo-description">'+U(a.FW)+"</p>"+(a.oI?U(rt({Oe:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-continue-button",content:ks(""+U(a.oI)),style:4})):"")+(a.wI?U(rt({Oe:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-close-button",content:ks(""+U(a.wI)),
style:4})):"")+"</div>")};function TW(a,b,c){YE.call(this,a,c);this.O=new st("",c);this.C=new st("",c);a=Or(Sbc,b);this.setContent(a);this.Eg("docs-promo-bubble");this.setPosition(0,0);this.F.vy=!0;Iq(this.D,!1);this.hv=!1}z(TW,YE);TW.prototype.Ha=function(){TW.Z.Ha.call(this);var a=T(this,"waffle-assistant-walkthrough-promo-continue-button");a&&this.O.Va(a);(a=T(this,"waffle-assistant-walkthrough-promo-close-button"))&&this.C.Va(a);this.getHandler().V(this.O,"action",this.J).V(this.C,"action",this.R)};
TW.prototype.J=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};TW.prototype.R=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};function Tbc(a){var b=Pm("waffle-assistant-chart-preview",void 0);TW.call(this,b,{WE:"See the big picture",FW:"Data visualizations and text summaries make it easier to spot trends and outliers",oI:"Learn more",wI:"Got it"},a)}z(Tbc,TW);var Ubc={defaultHelpArticleId:"6280499"};Tbc.prototype.J=function(a){Q.Hm.Wb(Ubc);Tbc.Z.J.call(this,a)};function Vbc(a,b){var c=Pm("waffle-assistant-answers-input",void 0),d;d=new aw;a="Interested in the "+(d.Am("b")+(a+(d.Mm("b")+"? Ask a question about your data to learn more, no formulas needed.")));d={WE:"Find answers in a snap",FW:d.format(a),oI:"Next",wI:"Dismiss"};TW.call(this,c,d,b)}z(Vbc,TW);function Wbc(a,b){a={Wf:"waffle-assistant-entry-promo",WE:"Get insights instantly",FW:om&&"en"==cD(a)?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore":"Apply formatting and create charts over your data in a single click using Sheets Explore",oI:"Check it out",wI:"Dismiss",oMa:"#0F9D58"};Rbc.call(this,a,b)}z(Wbc,Rbc);function Xbc(a){var b=Pm("waffle-assistant-banding-color-picker-container",void 0);TW.call(this,b,{WE:"Make it pop",FW:"Quickly apply alternating row color formatting to add style, polish, and visual appeal",oI:"Next",wI:"Dismiss"},a)}z(Xbc,TW);function Ybc(a,b,c,d,e,g,h,k,l){yU.call(this,b,h);this.La=a;this.C=b;this.X=c;this.Ga=d;this.Ua=e;this.Y=g;this.Pa=k;this.R=c.C;this.Da=this.va=!1;this.J=l;this.D=null;this.wb=new Li;this.O=null;a=vw(this.Ua);this.qa.V(this.Ga,"selectionChange",this.kWb).V(this.R,"Sa",this.jWb).V(a,"kb",this.osb).V(this.C,"assistant-sidepane-apply-conditional-format-rules",this.Ohb).V(this.C,"assistant-sidepane-apply-banding",this.Nhb).V(this.C,"assistant-sidepane-remove-banding",this.nwb).V(this.C,"assistant-sidepane-change-selection",
this.ejb).V(this.C,"assistant-sidepane-insert-chart",this.fqb).V(this.C,"assistant-sidepane-thumbs",this.czb).V(this.C,"assistant-sidepane-set-active-panel",this.Yxb).V(this.C,"assistant-sidepane-back-button-clicked",this.jib).V(this.C,"assistant-undo-pressed",this.lWb).V(this.La,"cu",this.ykb);To(this.L,X.RG,eo,this.iqb).subscribe(X.ZT,"action",this.gib).subscribe(X.K1,"action",this.Qyb).subscribe(X.Wca,"action",this.Lyb);X.J1.Qa(!0);this.Tc=Wo(new Vo,10).Fa();this.Ka=wJ.getInstance();this.ea=xJ(this.Ka,
lj.Hva);bl(Fa(this.kW,!1),100,this)}z(Ybc,yU);q=Ybc.prototype;q.Gh=function(){return X.Yca};q.Us=function(){return X.Zca};q.rs=function(a){Ybc.Z.rs.call(this,a);X.K1.Qa(a);this.kW(!1);!this.va&&a&&(this.va=!0,Doa&&yK(this.Pa,"ritz-DisplayExploreV2Promo",!1))};q.lh=function(a){this.C.lh(a);this.La.lh(a)};q.gib=function(){var a=this.C.Ta();this.Gh().setVisible(!a);a?this.J.Pb(2226,this.Tc):(this.C.focus(),this.J.Pb(2253,this.Tc))};q.Lyb=function(){this.C.Ta()||this.rs(!0)};
q.Qyb=function(a){Ibc(this.C,a)};q.kWb=function(){this.kW(!0);this.D&&(J(this.D),this.D=null)};q.kW=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.O&&b[0].equals(this.O)){this.O=null;return}}var c=this.C;c.Ta()&&(obc(c.Y),QW(c));this.La.update(!a,this.C.Ta(),b)};
q.ykb=function(a){""!=this.ea&&(yJ(this.Ka,this.ea),this.ea="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&50<=Kh(c)&&5<=Fh(c,"r")&&3<=Fh(c,"c")&&5E4>=Kh(c))&&.6<=b;d!==this.Da&&(this.Da=d,X.J1.Wb(d));if(c){if(a&&a.rect){var d=.9<=b,e=1E3>=Kh(a.rect),c=ritz.isFormsRegion(""+a.vd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),d=toa&&!this.C.Ta()&&!this.va&&d&&e&&!pw(this.X.F),c=uoa&&c,e=voa&&this.X.Id();d&&(c||e)?(d=new l9b,P(d,1,b),P(d,2,c),P(d,3,e),c=new io,fj(c,58,
d),this.kAa(new Uo(10,c)),c=!0):c=!1}else c=!1;if(c=!c)if(c=Doa){if(b=.6<=b&&!this.C.Ta()&&!this.va&&!this.D&&this.Pa.C["ritz-DisplayExploreV2Promo"].Ia()&&a)b=a.rect,b=ritz.hasBandingSuggestions(a.vd+"",b.jc(),b.Uc(),b.bc(),b.bd());c=b}c&&(a=this.X.O.Fr(),this.D=new Wbc(a),H(this,this.D),this.D.show(),this.L.subscribe(Q.qda,"action",this.pnb).subscribe(Q.rda,"action",this.xma),yK(this.Pa,"ritz-DisplayExploreV2Promo",!1),this.J.Pb(2788,this.Tc))}};
q.kAa=function(a){this.C.bb=!0;var b=jOa(xw(this.R));oKb.C||b||(a=a||this.Tc,this.Gh().setVisible(!0),this.J.Pb(2225,a),bl(Fa(this.W2a,a),5E3,this))};q.W2a=function(a){this.C.Ta()||this.J.Pb(2752,a)};q.xma=function(){J(this.D);this.D=null};
q.pnb=function(){J(this.D);this.rs(!0);Gf(this.qa,this.C,"assistant-done-rendering",y(function(){var a;a:{this.C.Ta();a=this.X.O.Fr();a=om&&"en"==cD(a);for(var b=!1,c=!1,d=!1,e=this.C.FG(),g=0;g<e.length;g++)if(e[g]instanceof wW?b=!0:e[g]instanceof IW?c=!0:e[g]instanceof nW&&(d=!0),c&&d&&(b||!a)){a=!0;break a}a=!1}a?this.FKa():this.xma()},this))};
q.FKa=function(){this.C.Ta();J(this.D);var a=null;this.D instanceof Wbc?(a=this.X.O.Fr(),om&&"en"==cD(a)?(a=this.C.KGa(),a=Tac(zb(a,function(a){return a instanceof HW}).L).toLowerCase(),a=new Vbc(a)):a=new Xbc):this.D instanceof Vbc?a=new Xbc:this.D instanceof Xbc&&(a=new Tbc);if(this.D=a)H(this,this.D),this.D.render(),Gf(Gf(this.qa,this.D,"promo-dismiss",this.xma),this.D,"promo-continue",this.FKa)};q.jib=function(){this.C.Fc()};
q.lWb=function(a){var b=a.C,c=b.D.mJ(),d=parseInt(c.fb(),10);this.O=Rh(c);this.Y.C(new hLb(d));ibc(b,c);this.J.Pb(a.Dj(),this.Tc)};q.jWb=function(){ww(this.R)?(this.C.Qa(!0),this.kW(!1)):(this.Gh().setVisible(!1),this.C.Qa(!1))};q.iqb=function(){this.C.Nca(!X.RG.isEnabled())};q.osb=function(a){this.kW(!1,a.C?a.C:a.rect?[a.rect]:[])};
q.Ohb=function(a){var b=xw(this.R),c=""+b.mc(),d=[],e=$4b(b);if(e){var b=new Ye,g=Gc(e,2);F(b,3,g);g=Gc(e,2);F(b,2,g);e=Gc(e,1);F(b,1,e);d.push(b)}b=a.C.mb;for(e=0;e<b.length;e++)g=new Ye,F(g,2,b[e]),d.push(g);this.Y.C(new DU(d,c));a=a.Dj();this.J.Pb(a,this.Tc)};
q.Nhb=function(a){var b=a.C,c=N5b(b.C),d=b.D.mJ(),e=c.It?c.lw:null,g=c.C?c.Wv:null,h=parseInt(d.fb(),10),k=Zbc(d);this.O=Rh(d);k?this.Y.C(new xU(k,h,this.O,e,c.zr,c.qs,g)):this.Y.C(new vU(h,this.O,e,c.zr,c.qs,g));d=new m5b;P(d,1,1);c=new RT;b=b.D.xS();P(c,2,b);fj(c,5,d);b=new io;fj(b,46,c);b=new Uo(10,b);a=a.Dj();this.J.Pb(a,b)};q.nwb=function(a){a=a.C;var b=a.D.mJ(),c=parseInt(b.fb(),10),d=Zbc(b);this.O=Rh(b);this.Y.C(new wU(d,c));ibc(a,b)};
function Zbc(a){var b=a.fb();a=Rh(a);b=ritz.getWorkbookRangeIntersectingIds(b,a.jc(),a.bc(),a.Uc(),a.bd(),7,!1);return 0<b.length?b[0]:null}q.ejb=function(a){CC(xw(this.R),a.F);a=a.Dj();this.J.Pb(a,this.Tc)};
q.czb=function(a){var b=a.C;a=a.Dj();if(b instanceof uW||b instanceof wW)this.J.Pb(a,this.Tc);else{var c=this.C.FG(),d=new RT,e=b.D.xS(),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new io;fj(e,46,d);if(b instanceof nW){(d=b.L)?(b=$bc(this,b,d),b=y8b(b,d,d.Sg)):b=null;if(!b)return;fj(e,39,b)}else if(b instanceof qW){var g=b.D,c=new n9b;if(b instanceof qW)b=1;else throw Error("Unknown text analysis card type.");g=Fc(g.getAutovisRecommendation(),20).slice(0,10);P(c,2,g||[]);P(c,1,b);fj(d,3,c)}this.J.Pb(a,new Uo(10,
e))}};q.Yxb=function(){this.C.Fc()};
q.fqb=function(a){var b=a.Y;if(b){var c=xw(this.R),d=a.Ve();d||(d=fA(this.Ga).ud().C.Ve());var e=16,g=16,h=a.wb;h&&(e=h.x,g=h.y);c={oid:null,ar:JC(c,d.y),ac:KC(c,d.x),x:e,y:g,h:FGa.height,w:FGa.width,p:{context:{chartName:"Chart "+(acc(this)+1)}}};d=new OH(rw(this.R)||0,c,!1,!1);c=b.Sg;e=new Dl(c);g=Pl(e,"headers");g=null!=g&&za(g)&&Ua(g)?parseInt(g,10):-1;d.Pa=g;d.va=0;g="1"==Pl(e,"transpose");d.La=g;d.O=g?"ROWS":"COLS";g=Pl(e,"range");g=d5b(c5b(g,","),this.R);d.SS(g);j4b(d,b);if(e=Pl(e,"dt"))e=
this.wb.od(ef.Ca(),JSON.parse(decodeURIComponent(e))),d.R=encodeURIComponent(JSON.stringify(d.Ua.serialize(e)));this.Ga.dispatchEvent(new QE("objectRequest"));this.Y.C(new JE(this.X,d));e=bcc(this,b,a.$,a.Se());d=this.J;a=a.Dj();b=y8b(e,b,c);c=new io;fj(c,39,b);d.Pb(a,new Uo(10,c))}};function $bc(a,b,c){var d=a.C.FG().filter(function(a){return a instanceof nW});return bcc(a,c,d.indexOf(b),b.L&&b.L.Se())}
function bcc(a,b,c,d){var e=new A8b;a=a.C.FG().filter(function(a){return a instanceof nW}).map(function(a){return a.getChartType()});e.R=a;e.F=c;B8b(e,b.getChartType());e.D=d?d.clone():null;return e}function acc(a){var b=0;gG(a.X.J,function(a){6==a.getType()&&b++});return b};function ccc(a,b){lW.call(this,a,b)}z(ccc,lW);q=ccc.prototype;q.cz=function(a){a()};q.Vy=oa;q.Px=n("assistantPivotTableFeedback");q.iE=n(2632);q.hE=n(2631);function dcc(a,b,c,d,e,g,h){PW.call(this,a,b,c,d,e,h);this.J=new wq(this.oa);this.Ma(this.J);this.F=null;this.Da=new M;H(this,this.Da);this.D=[];this.Za=null;this.X=!0}z(dcc,PW);var ecc={JWa:"waffle-assistant-card-holder",kz:"waffle-assistant-sidepane-content",MXa:"waffle-assistant-dragger-card",LXa:"waffle-assistant-dragged-card",SXa:"waffle-assistant-empty-list-old",VISIBLE:"waffle-assistant-visible"};q=dcc.prototype;q.Qta=function(){return Kbc};q.Fja=n("waffle-assistant-empty-list-old");
q.Ha=function(){dcc.Z.Ha.call(this);var a=T(this,ecc.JWa);this.J.Va(a)};q.setVisible=function(a){var b=this.Ta();dcc.Z.setVisible.call(this,a);a&&!b&&(this.X=!0)};
q.Pta=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=D(c,1),e=null;switch(d){case 0:"WordCloud"==c.getAutovisRecommendation().getChartType()?e=new qW(c,this.oa):e=new nW(c,this.Gb,this.Ka,this.L,null,this.oa);break;case 1:e=new ccc(c,this.oa);break;case 2:e=new JW(c,this.oa);break;case 4:e=new IW(c,this.L,this.oa);break;default:throw Error("Unsupported recommendation type: "+d);}c=this.J.qd();e.Y=c;this.J.Ma(e,!0);if(X.RG.isEnabled()){if(!this.F||this.F.isDisposed())this.F=new fcc,P5b(this.F,
this.J.Ba),this.F.X=10,this.F.R=Xa(ecc.MXa).split(" "),this.F.ea=!0,this.F.cra(ecc.VISIBLE),this.F.L=!1,this.F.We(),this.Da.V(this.F,"beforedragstart",y(this.mWb,this)).V(this.F,"dragstart",y(this.nWb,this)).V(this.F,"beforedragend",y(this.tib,this));var c=this.F,d=this.J.Ba,g=e.Ba;u(void 0)?qpa(d,g,void 0):d.appendChild(g);Q5b(c,g)}0!=this.D.length&&e.getHandler().V(this.D[this.D.length-1],"content-rendered",e.sO);this.D.push(e)}};
q.Rta=function(a){0<this.D.length&&this.D[0].sO();if(a||this.X)this.X=!1,gcc(this)};function gcc(a){if(0!=a.D.length){for(var b=0,c=0;c<a.D.length;c++){var d=a.D[c].Ba;Qp(d,0,1E3);b+=cq(d).height}b=Math.max(cq(T(a,"waffle-assistant-sidepane-content")).height,b);bq(a.J.Ba,b);for(c=0;c<a.D.length;c++)bl(Fa(a.B1a,a.D[c]),100*c,a);bl(function(){bq(this.J.Ba,"auto")},100*a.D.length,a)}}q.B1a=function(a){!a.isDisposed()&&this.isEnabled()&&(new iU(a.Ba,[0,1E3],[0,0],100)).play()};
q.zT=function(){this.Da.Gc();J(this.F);for(var a=0;a<this.D.length;a++){var b=this.D[a];b.rc()&&this.J.removeChild(b,!0);J(b)}this.D=[]};q.M9=function(){return 0<this.D.length};q.u1=function(){for(var a=Jbc(this),b=0,c=0;c<this.D.length;c++)b<a?(VV(this.D[c],!0),b+=cq(this.D[c].Ba).height):VV(this.D[c],!1)};q.mWb=function(a){var b=sb(this.J.Ba.childNodes,a.C),b=this.J.Ad(b);b.YMa()?this.Za=b:a.preventDefault()};q.nWb=function(a){Dp(a.F,ecc.LXa)};
q.tib=function(a){var b=Rp(a.F),c=fA(this.Ka).C;if(ph(tE(c,"page",!1,!1)).contains(b)){var d=rE(c,b.x,b.y,"page"),c=vE(c,vh(d),"page");this.Za.B8(d,new N(b.x-c.left,b.y-c.top))}a.Y.gw(null,!0);a.preventDefault();this.Za=null};q.FG=f("D");function fcc(){EU.call(this)}z(fcc,EU);fcc.prototype.Ika=function(a){a=fcc.Z.Ika.call(this,a);var b=vb(a.querySelectorAll("clippath"),function(a){return a.id});hcc(a,b);return a};
function hcc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];za(c)&&cb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=en(a);for(d=0;d<a.length;d++)hcc(a[d],b)};function icc(){G.call(this)}z(icc,Jn);icc.prototype.C=function(){return xbc};icc.prototype.F=function(){return xoa||yoa||om?RW:dcc};icc.prototype.D=function(){return Ybc};Rn("assistant",icc);
